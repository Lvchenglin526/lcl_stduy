D:\ANACONDA\envs\py312\python.exe "D:\AI  Learning\课程内容\SEVEN_Week\SEVENWEEK\week7 文本分类问题\nn_pipline\main.py" 
2025-12-03 21:24:21,455 - __main__ - INFO - epoch 1 begin
2025-12-03 21:24:21,553 - __main__ - INFO - batch loss 3.067631
2025-12-03 21:24:24,818 - __main__ - INFO - batch loss 0.424657
2025-12-03 21:24:28,181 - __main__ - INFO - batch loss 0.389624
2025-12-03 21:24:28,182 - __main__ - INFO - epoch average loss: 0.599887
2025-12-03 21:24:28,182 - __main__ - INFO - 开始测试第1轮模型效果：
2025-12-03 21:24:28,847 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:24:28,848 - __main__ - INFO - 预测正确条目：2046，预测错误条目：352
2025-12-03 21:24:28,848 - __main__ - INFO - 预测准确率：0.853211
2025-12-03 21:24:28,848 - __main__ - INFO - --------------------
2025-12-03 21:24:28,848 - __main__ - INFO - epoch 2 begin
2025-12-03 21:24:28,935 - __main__ - INFO - batch loss 0.379135
2025-12-03 21:24:32,188 - __main__ - INFO - batch loss 0.319965
2025-12-03 21:24:35,420 - __main__ - INFO - batch loss 0.280071
2025-12-03 21:24:35,420 - __main__ - INFO - epoch average loss: 0.348223
2025-12-03 21:24:35,420 - __main__ - INFO - 开始测试第2轮模型效果：
2025-12-03 21:24:36,094 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:24:36,094 - __main__ - INFO - 预测正确条目：2119，预测错误条目：279
2025-12-03 21:24:36,094 - __main__ - INFO - 预测准确率：0.883653
2025-12-03 21:24:36,094 - __main__ - INFO - --------------------
2025-12-03 21:24:36,094 - __main__ - INFO - epoch 3 begin
2025-12-03 21:24:36,187 - __main__ - INFO - batch loss 0.281610
2025-12-03 21:24:39,772 - __main__ - INFO - batch loss 0.316218
2025-12-03 21:24:43,519 - __main__ - INFO - batch loss 0.249703
2025-12-03 21:24:43,519 - __main__ - INFO - epoch average loss: 0.287185
2025-12-03 21:24:43,519 - __main__ - INFO - 开始测试第3轮模型效果：
2025-12-03 21:24:44,387 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:24:44,387 - __main__ - INFO - 预测正确条目：2145，预测错误条目：253
2025-12-03 21:24:44,387 - __main__ - INFO - 预测准确率：0.894495
2025-12-03 21:24:44,387 - __main__ - INFO - --------------------
2025-12-03 21:24:44,387 - __main__ - INFO - epoch 4 begin
2025-12-03 21:24:44,483 - __main__ - INFO - batch loss 0.162066
2025-12-03 21:24:48,153 - __main__ - INFO - batch loss 0.221738
2025-12-03 21:24:51,777 - __main__ - INFO - batch loss 0.232776
2025-12-03 21:24:51,777 - __main__ - INFO - epoch average loss: 0.250359
2025-12-03 21:24:51,777 - __main__ - INFO - 开始测试第4轮模型效果：
2025-12-03 21:24:52,639 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:24:52,640 - __main__ - INFO - 预测正确条目：2144，预测错误条目：254
2025-12-03 21:24:52,640 - __main__ - INFO - 预测准确率：0.894078
2025-12-03 21:24:52,640 - __main__ - INFO - --------------------
2025-12-03 21:24:52,640 - __main__ - INFO - epoch 5 begin
2025-12-03 21:24:52,740 - __main__ - INFO - batch loss 0.203779
2025-12-03 21:24:56,424 - __main__ - INFO - batch loss 0.163766
2025-12-03 21:25:00,034 - __main__ - INFO - batch loss 0.258496
2025-12-03 21:25:00,035 - __main__ - INFO - epoch average loss: 0.216903
2025-12-03 21:25:00,035 - __main__ - INFO - 开始测试第5轮模型效果：
2025-12-03 21:25:00,923 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:25:00,924 - __main__ - INFO - 预测正确条目：2125，预测错误条目：273
2025-12-03 21:25:00,924 - __main__ - INFO - 预测准确率：0.886155
2025-12-03 21:25:00,924 - __main__ - INFO - --------------------
2025-12-03 21:25:00,924 - __main__ - INFO - epoch 6 begin
2025-12-03 21:25:01,024 - __main__ - INFO - batch loss 0.226135
2025-12-03 21:25:04,658 - __main__ - INFO - batch loss 0.178621
2025-12-03 21:25:08,215 - __main__ - INFO - batch loss 0.178161
2025-12-03 21:25:08,216 - __main__ - INFO - epoch average loss: 0.184069
2025-12-03 21:25:08,216 - __main__ - INFO - 开始测试第6轮模型效果：
2025-12-03 21:25:09,067 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:25:09,067 - __main__ - INFO - 预测正确条目：2133，预测错误条目：265
2025-12-03 21:25:09,067 - __main__ - INFO - 预测准确率：0.889491
2025-12-03 21:25:09,068 - __main__ - INFO - --------------------
2025-12-03 21:25:09,068 - __main__ - INFO - epoch 7 begin
2025-12-03 21:25:09,170 - __main__ - INFO - batch loss 0.144758
2025-12-03 21:25:12,858 - __main__ - INFO - batch loss 0.154713
2025-12-03 21:25:16,548 - __main__ - INFO - batch loss 0.192680
2025-12-03 21:25:16,549 - __main__ - INFO - epoch average loss: 0.164378
2025-12-03 21:25:16,549 - __main__ - INFO - 开始测试第7轮模型效果：
2025-12-03 21:25:17,400 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:25:17,400 - __main__ - INFO - 预测正确条目：2147，预测错误条目：251
2025-12-03 21:25:17,400 - __main__ - INFO - 预测准确率：0.895329
2025-12-03 21:25:17,400 - __main__ - INFO - --------------------
2025-12-03 21:25:17,400 - __main__ - INFO - epoch 8 begin
2025-12-03 21:25:17,502 - __main__ - INFO - batch loss 0.111565
2025-12-03 21:25:21,179 - __main__ - INFO - batch loss 0.121252
2025-12-03 21:25:24,893 - __main__ - INFO - batch loss 0.144559
2025-12-03 21:25:24,894 - __main__ - INFO - epoch average loss: 0.135546
2025-12-03 21:25:24,894 - __main__ - INFO - 开始测试第8轮模型效果：
2025-12-03 21:25:25,723 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:25:25,723 - __main__ - INFO - 预测正确条目：2126，预测错误条目：272
2025-12-03 21:25:25,723 - __main__ - INFO - 预测准确率：0.886572
2025-12-03 21:25:25,723 - __main__ - INFO - --------------------
2025-12-03 21:25:25,723 - __main__ - INFO - epoch 9 begin
2025-12-03 21:25:25,820 - __main__ - INFO - batch loss 0.139380
2025-12-03 21:25:29,649 - __main__ - INFO - batch loss 0.095655
2025-12-03 21:25:34,017 - __main__ - INFO - batch loss 0.102681
2025-12-03 21:25:34,017 - __main__ - INFO - epoch average loss: 0.115424
2025-12-03 21:25:34,017 - __main__ - INFO - 开始测试第9轮模型效果：
2025-12-03 21:25:34,859 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:25:34,859 - __main__ - INFO - 预测正确条目：2137，预测错误条目：261
2025-12-03 21:25:34,859 - __main__ - INFO - 预测准确率：0.891159
2025-12-03 21:25:34,859 - __main__ - INFO - --------------------
2025-12-03 21:25:34,859 - __main__ - INFO - epoch 10 begin
2025-12-03 21:25:34,961 - __main__ - INFO - batch loss 0.046932
2025-12-03 21:25:38,917 - __main__ - INFO - batch loss 0.053708
2025-12-03 21:25:43,182 - __main__ - INFO - batch loss 0.132670
2025-12-03 21:25:43,183 - __main__ - INFO - epoch average loss: 0.090509
2025-12-03 21:25:43,183 - __main__ - INFO - 开始测试第10轮模型效果：
2025-12-03 21:25:44,069 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:25:44,069 - __main__ - INFO - 预测正确条目：2120，预测错误条目：278
2025-12-03 21:25:44,069 - __main__ - INFO - 预测准确率：0.884070
2025-12-03 21:25:44,069 - __main__ - INFO - --------------------
2025-12-03 21:25:44,537 - __main__ - INFO - epoch 1 begin
2025-12-03 21:25:44,636 - __main__ - INFO - batch loss 3.133661
2025-12-03 21:25:48,306 - __main__ - INFO - batch loss 0.405254
2025-12-03 21:25:51,708 - __main__ - INFO - batch loss 0.401076
2025-12-03 21:25:51,709 - __main__ - INFO - epoch average loss: 0.568307
2025-12-03 21:25:51,709 - __main__ - INFO - 开始测试第1轮模型效果：
2025-12-03 21:25:52,391 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:25:52,391 - __main__ - INFO - 预测正确条目：2051，预测错误条目：347
2025-12-03 21:25:52,391 - __main__ - INFO - 预测准确率：0.855296
2025-12-03 21:25:52,391 - __main__ - INFO - --------------------
2025-12-03 21:25:52,391 - __main__ - INFO - epoch 2 begin
2025-12-03 21:25:52,484 - __main__ - INFO - batch loss 0.270445
2025-12-03 21:25:55,859 - __main__ - INFO - batch loss 0.313166
2025-12-03 21:25:59,200 - __main__ - INFO - batch loss 0.324539
2025-12-03 21:25:59,200 - __main__ - INFO - epoch average loss: 0.316955
2025-12-03 21:25:59,200 - __main__ - INFO - 开始测试第2轮模型效果：
2025-12-03 21:25:59,863 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:25:59,863 - __main__ - INFO - 预测正确条目：2104，预测错误条目：294
2025-12-03 21:25:59,863 - __main__ - INFO - 预测准确率：0.877398
2025-12-03 21:25:59,863 - __main__ - INFO - --------------------
2025-12-03 21:25:59,863 - __main__ - INFO - epoch 3 begin
2025-12-03 21:25:59,962 - __main__ - INFO - batch loss 0.239443
2025-12-03 21:26:03,551 - __main__ - INFO - batch loss 0.379520
2025-12-03 21:26:07,185 - __main__ - INFO - batch loss 0.262301
2025-12-03 21:26:07,185 - __main__ - INFO - epoch average loss: 0.266562
2025-12-03 21:26:07,185 - __main__ - INFO - 开始测试第3轮模型效果：
2025-12-03 21:26:08,014 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:26:08,014 - __main__ - INFO - 预测正确条目：2132，预测错误条目：266
2025-12-03 21:26:08,014 - __main__ - INFO - 预测准确率：0.889074
2025-12-03 21:26:08,014 - __main__ - INFO - --------------------
2025-12-03 21:26:08,014 - __main__ - INFO - epoch 4 begin
2025-12-03 21:26:08,111 - __main__ - INFO - batch loss 0.176928
2025-12-03 21:26:11,984 - __main__ - INFO - batch loss 0.386695
2025-12-03 21:26:16,010 - __main__ - INFO - batch loss 0.225555
2025-12-03 21:26:16,010 - __main__ - INFO - epoch average loss: 0.230582
2025-12-03 21:26:16,010 - __main__ - INFO - 开始测试第4轮模型效果：
2025-12-03 21:26:16,872 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:26:16,873 - __main__ - INFO - 预测正确条目：2142，预测错误条目：256
2025-12-03 21:26:16,873 - __main__ - INFO - 预测准确率：0.893244
2025-12-03 21:26:16,873 - __main__ - INFO - --------------------
2025-12-03 21:26:16,873 - __main__ - INFO - epoch 5 begin
2025-12-03 21:26:16,971 - __main__ - INFO - batch loss 0.233271
2025-12-03 21:26:20,731 - __main__ - INFO - batch loss 0.187165
2025-12-03 21:26:24,662 - __main__ - INFO - batch loss 0.290628
2025-12-03 21:26:24,662 - __main__ - INFO - epoch average loss: 0.196104
2025-12-03 21:26:24,662 - __main__ - INFO - 开始测试第5轮模型效果：
2025-12-03 21:26:25,517 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:26:25,517 - __main__ - INFO - 预测正确条目：2125，预测错误条目：273
2025-12-03 21:26:25,517 - __main__ - INFO - 预测准确率：0.886155
2025-12-03 21:26:25,517 - __main__ - INFO - --------------------
2025-12-03 21:26:25,518 - __main__ - INFO - epoch 6 begin
2025-12-03 21:26:25,648 - __main__ - INFO - batch loss 0.151304
2025-12-03 21:26:29,498 - __main__ - INFO - batch loss 0.279278
2025-12-03 21:26:33,059 - __main__ - INFO - batch loss 0.283493
2025-12-03 21:26:33,059 - __main__ - INFO - epoch average loss: 0.186275
2025-12-03 21:26:33,059 - __main__ - INFO - 开始测试第6轮模型效果：
2025-12-03 21:26:33,950 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:26:33,950 - __main__ - INFO - 预测正确条目：2118，预测错误条目：280
2025-12-03 21:26:33,950 - __main__ - INFO - 预测准确率：0.883236
2025-12-03 21:26:33,950 - __main__ - INFO - --------------------
2025-12-03 21:26:33,950 - __main__ - INFO - epoch 7 begin
2025-12-03 21:26:34,051 - __main__ - INFO - batch loss 0.127256
2025-12-03 21:26:37,646 - __main__ - INFO - batch loss 0.149320
2025-12-03 21:26:41,484 - __main__ - INFO - batch loss 0.114895
2025-12-03 21:26:41,484 - __main__ - INFO - epoch average loss: 0.142320
2025-12-03 21:26:41,484 - __main__ - INFO - 开始测试第7轮模型效果：
2025-12-03 21:26:42,428 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:26:42,428 - __main__ - INFO - 预测正确条目：2145，预测错误条目：253
2025-12-03 21:26:42,428 - __main__ - INFO - 预测准确率：0.894495
2025-12-03 21:26:42,428 - __main__ - INFO - --------------------
2025-12-03 21:26:42,428 - __main__ - INFO - epoch 8 begin
2025-12-03 21:26:42,544 - __main__ - INFO - batch loss 0.120095
2025-12-03 21:26:46,494 - __main__ - INFO - batch loss 0.187980
2025-12-03 21:26:50,072 - __main__ - INFO - batch loss 0.147895
2025-12-03 21:26:50,073 - __main__ - INFO - epoch average loss: 0.117607
2025-12-03 21:26:50,073 - __main__ - INFO - 开始测试第8轮模型效果：
2025-12-03 21:26:50,944 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:26:50,944 - __main__ - INFO - 预测正确条目：2115，预测错误条目：283
2025-12-03 21:26:50,944 - __main__ - INFO - 预测准确率：0.881985
2025-12-03 21:26:50,944 - __main__ - INFO - --------------------
2025-12-03 21:26:50,944 - __main__ - INFO - epoch 9 begin
2025-12-03 21:26:51,043 - __main__ - INFO - batch loss 0.082767
2025-12-03 21:26:54,629 - __main__ - INFO - batch loss 0.069065
2025-12-03 21:26:58,188 - __main__ - INFO - batch loss 0.088114
2025-12-03 21:26:58,188 - __main__ - INFO - epoch average loss: 0.089559
2025-12-03 21:26:58,188 - __main__ - INFO - 开始测试第9轮模型效果：
2025-12-03 21:26:59,027 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:26:59,027 - __main__ - INFO - 预测正确条目：2137，预测错误条目：261
2025-12-03 21:26:59,027 - __main__ - INFO - 预测准确率：0.891159
2025-12-03 21:26:59,027 - __main__ - INFO - --------------------
2025-12-03 21:26:59,027 - __main__ - INFO - epoch 10 begin
2025-12-03 21:26:59,123 - __main__ - INFO - batch loss 0.048186
2025-12-03 21:27:02,714 - __main__ - INFO - batch loss 0.092123
2025-12-03 21:27:06,255 - __main__ - INFO - batch loss 0.054352
2025-12-03 21:27:06,255 - __main__ - INFO - epoch average loss: 0.062815
2025-12-03 21:27:06,255 - __main__ - INFO - 开始测试第10轮模型效果：
2025-12-03 21:27:07,078 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:27:07,078 - __main__ - INFO - 预测正确条目：2129，预测错误条目：269
2025-12-03 21:27:07,078 - __main__ - INFO - 预测准确率：0.887823
2025-12-03 21:27:07,078 - __main__ - INFO - --------------------
最后一轮准确率： 0.8878231859883235 当前配置： {'model_path': 'output', 'train_data_path': '../data/train_tag_news.json', 'valid_data_path': '../data/test_tag_news.json', 'vocab_path': 'chars.txt', 'model_type': 'rnn', 'max_length': 30, 'hidden_size': 256, 'kernel_size': 3, 'num_layers': 2, 'epoch': 10, 'batch_size': 128, 'pooling_style': 'max', 'optimizer': 'adam', 'learning_rate': 0.001, 'pretrain_model_path': 'D:\\ANACONDA\\envs\\py312\\Lib\\site-packages\\modelscope\\hub\\models\\google-bert\\bert-base-chinese', 'seed': 987, 'class_num': 18, 'vocab_size': 4622}
model_name: gated_cnn
learning_rate: 0.001
hidden_size: 128
batch_size: 64
2025-12-03 21:27:07,685 - __main__ - INFO - epoch 1 begin
2025-12-03 21:27:07,699 - __main__ - INFO - batch loss 2.889226
2025-12-03 21:27:08,776 - __main__ - INFO - batch loss 0.325357
2025-12-03 21:27:09,855 - __main__ - INFO - epoch average loss: 0.719140
2025-12-03 21:27:09,855 - __main__ - INFO - 开始测试第1轮模型效果：
2025-12-03 21:27:10,035 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:27:10,035 - __main__ - INFO - 预测正确条目：2060，预测错误条目：338
2025-12-03 21:27:10,035 - __main__ - INFO - 预测准确率：0.859049
2025-12-03 21:27:10,035 - __main__ - INFO - --------------------
2025-12-03 21:27:10,035 - __main__ - INFO - epoch 2 begin
2025-12-03 21:27:10,051 - __main__ - INFO - batch loss 0.406331
2025-12-03 21:27:11,144 - __main__ - INFO - batch loss 0.434608
2025-12-03 21:27:12,199 - __main__ - INFO - epoch average loss: 0.352119
2025-12-03 21:27:12,199 - __main__ - INFO - 开始测试第2轮模型效果：
2025-12-03 21:27:12,375 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:27:12,375 - __main__ - INFO - 预测正确条目：2073，预测错误条目：325
2025-12-03 21:27:12,375 - __main__ - INFO - 预测准确率：0.864470
2025-12-03 21:27:12,375 - __main__ - INFO - --------------------
2025-12-03 21:27:12,375 - __main__ - INFO - epoch 3 begin
2025-12-03 21:27:12,389 - __main__ - INFO - batch loss 0.410849
2025-12-03 21:27:13,477 - __main__ - INFO - batch loss 0.271111
2025-12-03 21:27:14,540 - __main__ - INFO - epoch average loss: 0.315661
2025-12-03 21:27:14,540 - __main__ - INFO - 开始测试第3轮模型效果：
2025-12-03 21:27:14,735 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:27:14,735 - __main__ - INFO - 预测正确条目：2117，预测错误条目：281
2025-12-03 21:27:14,735 - __main__ - INFO - 预测准确率：0.882819
2025-12-03 21:27:14,735 - __main__ - INFO - --------------------
2025-12-03 21:27:14,735 - __main__ - INFO - epoch 4 begin
2025-12-03 21:27:14,755 - __main__ - INFO - batch loss 0.336341
2025-12-03 21:27:15,945 - __main__ - INFO - batch loss 0.402225
2025-12-03 21:27:17,115 - __main__ - INFO - epoch average loss: 0.292621
2025-12-03 21:27:17,115 - __main__ - INFO - 开始测试第4轮模型效果：
2025-12-03 21:27:17,310 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:27:17,310 - __main__ - INFO - 预测正确条目：2142，预测错误条目：256
2025-12-03 21:27:17,310 - __main__ - INFO - 预测准确率：0.893244
2025-12-03 21:27:17,310 - __main__ - INFO - --------------------
2025-12-03 21:27:17,310 - __main__ - INFO - epoch 5 begin
2025-12-03 21:27:17,326 - __main__ - INFO - batch loss 0.357534
2025-12-03 21:27:18,518 - __main__ - INFO - batch loss 0.307022
2025-12-03 21:27:19,648 - __main__ - INFO - epoch average loss: 0.268254
2025-12-03 21:27:19,648 - __main__ - INFO - 开始测试第5轮模型效果：
2025-12-03 21:27:19,829 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:27:19,829 - __main__ - INFO - 预测正确条目：2137，预测错误条目：261
2025-12-03 21:27:19,829 - __main__ - INFO - 预测准确率：0.891159
2025-12-03 21:27:19,829 - __main__ - INFO - --------------------
2025-12-03 21:27:19,830 - __main__ - INFO - epoch 6 begin
2025-12-03 21:27:19,845 - __main__ - INFO - batch loss 0.209672
2025-12-03 21:27:21,029 - __main__ - INFO - batch loss 0.149584
2025-12-03 21:27:22,190 - __main__ - INFO - epoch average loss: 0.254543
2025-12-03 21:27:22,190 - __main__ - INFO - 开始测试第6轮模型效果：
2025-12-03 21:27:22,363 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:27:22,363 - __main__ - INFO - 预测正确条目：2141，预测错误条目：257
2025-12-03 21:27:22,363 - __main__ - INFO - 预测准确率：0.892827
2025-12-03 21:27:22,363 - __main__ - INFO - --------------------
2025-12-03 21:27:22,364 - __main__ - INFO - epoch 7 begin
2025-12-03 21:27:22,378 - __main__ - INFO - batch loss 0.176547
2025-12-03 21:27:23,537 - __main__ - INFO - batch loss 0.326434
2025-12-03 21:27:24,721 - __main__ - INFO - epoch average loss: 0.240659
2025-12-03 21:27:24,721 - __main__ - INFO - 开始测试第7轮模型效果：
2025-12-03 21:27:24,914 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:27:24,915 - __main__ - INFO - 预测正确条目：2150，预测错误条目：248
2025-12-03 21:27:24,915 - __main__ - INFO - 预测准确率：0.896580
2025-12-03 21:27:24,915 - __main__ - INFO - --------------------
2025-12-03 21:27:24,915 - __main__ - INFO - epoch 8 begin
2025-12-03 21:27:24,931 - __main__ - INFO - batch loss 0.257321
2025-12-03 21:27:26,130 - __main__ - INFO - batch loss 0.206035
2025-12-03 21:27:27,284 - __main__ - INFO - epoch average loss: 0.229069
2025-12-03 21:27:27,285 - __main__ - INFO - 开始测试第8轮模型效果：
2025-12-03 21:27:27,453 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:27:27,454 - __main__ - INFO - 预测正确条目：2148，预测错误条目：250
2025-12-03 21:27:27,454 - __main__ - INFO - 预测准确率：0.895746
2025-12-03 21:27:27,454 - __main__ - INFO - --------------------
2025-12-03 21:27:27,454 - __main__ - INFO - epoch 9 begin
2025-12-03 21:27:27,468 - __main__ - INFO - batch loss 0.221547
2025-12-03 21:27:28,547 - __main__ - INFO - batch loss 0.160168
2025-12-03 21:27:29,683 - __main__ - INFO - epoch average loss: 0.218568
2025-12-03 21:27:29,683 - __main__ - INFO - 开始测试第9轮模型效果：
2025-12-03 21:27:29,865 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:27:29,865 - __main__ - INFO - 预测正确条目：2153，预测错误条目：245
2025-12-03 21:27:29,865 - __main__ - INFO - 预测准确率：0.897832
2025-12-03 21:27:29,865 - __main__ - INFO - --------------------
2025-12-03 21:27:29,866 - __main__ - INFO - epoch 10 begin
2025-12-03 21:27:29,877 - __main__ - INFO - batch loss 0.207322
2025-12-03 21:27:30,954 - __main__ - INFO - batch loss 0.133988
2025-12-03 21:27:32,027 - __main__ - INFO - epoch average loss: 0.208157
2025-12-03 21:27:32,027 - __main__ - INFO - 开始测试第10轮模型效果：
2025-12-03 21:27:32,207 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:27:32,207 - __main__ - INFO - 预测正确条目：2141，预测错误条目：257
2025-12-03 21:27:32,208 - __main__ - INFO - 预测准确率：0.892827
2025-12-03 21:27:32,208 - __main__ - INFO - --------------------
最后一轮准确率： 0.8928273561301084 当前配置： {'model_path': 'output', 'train_data_path': '../data/train_tag_news.json', 'valid_data_path': '../data/test_tag_news.json', 'vocab_path': 'chars.txt', 'model_type': 'gated_cnn', 'max_length': 30, 'hidden_size': 128, 'kernel_size': 3, 'num_layers': 2, 'epoch': 10, 'batch_size': 64, 'pooling_style': 'avg', 'optimizer': 'adam', 'learning_rate': 0.001, 'pretrain_model_path': 'D:\\ANACONDA\\envs\\py312\\Lib\\site-packages\\modelscope\\hub\\models\\google-bert\\bert-base-chinese', 'seed': 987, 'class_num': 18, 'vocab_size': 4622}
2025-12-03 21:27:32,639 - __main__ - INFO - epoch 1 begin
2025-12-03 21:27:32,658 - __main__ - INFO - batch loss 2.787302
2025-12-03 21:27:33,970 - __main__ - INFO - batch loss 0.236721
2025-12-03 21:27:35,246 - __main__ - INFO - epoch average loss: 0.473125
2025-12-03 21:27:35,246 - __main__ - INFO - 开始测试第1轮模型效果：
2025-12-03 21:27:35,456 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:27:35,456 - __main__ - INFO - 预测正确条目：2137，预测错误条目：261
2025-12-03 21:27:35,456 - __main__ - INFO - 预测准确率：0.891159
2025-12-03 21:27:35,456 - __main__ - INFO - --------------------
2025-12-03 21:27:35,456 - __main__ - INFO - epoch 2 begin
2025-12-03 21:27:35,473 - __main__ - INFO - batch loss 0.343538
2025-12-03 21:27:36,669 - __main__ - INFO - batch loss 0.197864
2025-12-03 21:27:37,863 - __main__ - INFO - epoch average loss: 0.263912
2025-12-03 21:27:37,863 - __main__ - INFO - 开始测试第2轮模型效果：
2025-12-03 21:27:38,066 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:27:38,066 - __main__ - INFO - 预测正确条目：2135，预测错误条目：263
2025-12-03 21:27:38,066 - __main__ - INFO - 预测准确率：0.890325
2025-12-03 21:27:38,066 - __main__ - INFO - --------------------
2025-12-03 21:27:38,066 - __main__ - INFO - epoch 3 begin
2025-12-03 21:27:38,083 - __main__ - INFO - batch loss 0.280144
2025-12-03 21:27:39,352 - __main__ - INFO - batch loss 0.129073
2025-12-03 21:27:40,719 - __main__ - INFO - epoch average loss: 0.204014
2025-12-03 21:27:40,719 - __main__ - INFO - 开始测试第3轮模型效果：
2025-12-03 21:27:40,948 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:27:40,948 - __main__ - INFO - 预测正确条目：2151，预测错误条目：247
2025-12-03 21:27:40,949 - __main__ - INFO - 预测准确率：0.896997
2025-12-03 21:27:40,949 - __main__ - INFO - --------------------
2025-12-03 21:27:40,949 - __main__ - INFO - epoch 4 begin
2025-12-03 21:27:40,968 - __main__ - INFO - batch loss 0.200252
2025-12-03 21:27:42,191 - __main__ - INFO - batch loss 0.149829
2025-12-03 21:27:44,111 - __main__ - INFO - epoch average loss: 0.155762
2025-12-03 21:27:44,112 - __main__ - INFO - 开始测试第4轮模型效果：
2025-12-03 21:27:44,569 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:27:44,569 - __main__ - INFO - 预测正确条目：2148，预测错误条目：250
2025-12-03 21:27:44,569 - __main__ - INFO - 预测准确率：0.895746
2025-12-03 21:27:44,569 - __main__ - INFO - --------------------
2025-12-03 21:27:44,570 - __main__ - INFO - epoch 5 begin
2025-12-03 21:27:44,588 - __main__ - INFO - batch loss 0.084207
2025-12-03 21:27:45,917 - __main__ - INFO - batch loss 0.109585
2025-12-03 21:27:47,268 - __main__ - INFO - epoch average loss: 0.108977
2025-12-03 21:27:47,269 - __main__ - INFO - 开始测试第5轮模型效果：
2025-12-03 21:27:47,476 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:27:47,476 - __main__ - INFO - 预测正确条目：2114，预测错误条目：284
2025-12-03 21:27:47,476 - __main__ - INFO - 预测准确率：0.881568
2025-12-03 21:27:47,476 - __main__ - INFO - --------------------
2025-12-03 21:27:47,476 - __main__ - INFO - epoch 6 begin
2025-12-03 21:27:47,492 - __main__ - INFO - batch loss 0.087992
2025-12-03 21:27:48,966 - __main__ - INFO - batch loss 0.163255
2025-12-03 21:27:50,268 - __main__ - INFO - epoch average loss: 0.071565
2025-12-03 21:27:50,268 - __main__ - INFO - 开始测试第6轮模型效果：
2025-12-03 21:27:50,527 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:27:50,528 - __main__ - INFO - 预测正确条目：2149，预测错误条目：249
2025-12-03 21:27:50,528 - __main__ - INFO - 预测准确率：0.896163
2025-12-03 21:27:50,528 - __main__ - INFO - --------------------
2025-12-03 21:27:50,528 - __main__ - INFO - epoch 7 begin
2025-12-03 21:27:50,550 - __main__ - INFO - batch loss 0.044910
2025-12-03 21:27:51,905 - __main__ - INFO - batch loss 0.073448
2025-12-03 21:27:53,173 - __main__ - INFO - epoch average loss: 0.045783
2025-12-03 21:27:53,173 - __main__ - INFO - 开始测试第7轮模型效果：
2025-12-03 21:27:53,408 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:27:53,408 - __main__ - INFO - 预测正确条目：2151，预测错误条目：247
2025-12-03 21:27:53,408 - __main__ - INFO - 预测准确率：0.896997
2025-12-03 21:27:53,408 - __main__ - INFO - --------------------
2025-12-03 21:27:53,408 - __main__ - INFO - epoch 8 begin
2025-12-03 21:27:53,427 - __main__ - INFO - batch loss 0.018881
2025-12-03 21:27:54,736 - __main__ - INFO - batch loss 0.040594
2025-12-03 21:27:55,925 - __main__ - INFO - epoch average loss: 0.029232
2025-12-03 21:27:55,925 - __main__ - INFO - 开始测试第8轮模型效果：
2025-12-03 21:27:56,141 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:27:56,141 - __main__ - INFO - 预测正确条目：2144，预测错误条目：254
2025-12-03 21:27:56,141 - __main__ - INFO - 预测准确率：0.894078
2025-12-03 21:27:56,141 - __main__ - INFO - --------------------
2025-12-03 21:27:56,141 - __main__ - INFO - epoch 9 begin
2025-12-03 21:27:56,160 - __main__ - INFO - batch loss 0.009865
2025-12-03 21:27:57,345 - __main__ - INFO - batch loss 0.033878
2025-12-03 21:27:58,665 - __main__ - INFO - epoch average loss: 0.019492
2025-12-03 21:27:58,666 - __main__ - INFO - 开始测试第9轮模型效果：
2025-12-03 21:27:58,892 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:27:58,892 - __main__ - INFO - 预测正确条目：2132，预测错误条目：266
2025-12-03 21:27:58,892 - __main__ - INFO - 预测准确率：0.889074
2025-12-03 21:27:58,892 - __main__ - INFO - --------------------
2025-12-03 21:27:58,892 - __main__ - INFO - epoch 10 begin
2025-12-03 21:27:58,914 - __main__ - INFO - batch loss 0.019682
2025-12-03 21:28:00,052 - __main__ - INFO - batch loss 0.009855
2025-12-03 21:28:01,131 - __main__ - INFO - epoch average loss: 0.015764
2025-12-03 21:28:01,131 - __main__ - INFO - 开始测试第10轮模型效果：
2025-12-03 21:28:01,313 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:28:01,314 - __main__ - INFO - 预测正确条目：2131，预测错误条目：267
2025-12-03 21:28:01,314 - __main__ - INFO - 预测准确率：0.888657
2025-12-03 21:28:01,314 - __main__ - INFO - --------------------
最后一轮准确率： 0.8886572143452878 当前配置： {'model_path': 'output', 'train_data_path': '../data/train_tag_news.json', 'valid_data_path': '../data/test_tag_news.json', 'vocab_path': 'chars.txt', 'model_type': 'gated_cnn', 'max_length': 30, 'hidden_size': 128, 'kernel_size': 3, 'num_layers': 2, 'epoch': 10, 'batch_size': 64, 'pooling_style': 'max', 'optimizer': 'adam', 'learning_rate': 0.001, 'pretrain_model_path': 'D:\\ANACONDA\\envs\\py312\\Lib\\site-packages\\modelscope\\hub\\models\\google-bert\\bert-base-chinese', 'seed': 987, 'class_num': 18, 'vocab_size': 4622}
batch_size: 128
2025-12-03 21:28:01,770 - __main__ - INFO - epoch 1 begin
2025-12-03 21:28:01,796 - __main__ - INFO - batch loss 2.865291
2025-12-03 21:28:02,653 - __main__ - INFO - batch loss 0.666830
2025-12-03 21:28:03,546 - __main__ - INFO - batch loss 0.559852
2025-12-03 21:28:03,547 - __main__ - INFO - epoch average loss: 1.065708
2025-12-03 21:28:03,547 - __main__ - INFO - 开始测试第1轮模型效果：
2025-12-03 21:28:03,706 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:28:03,706 - __main__ - INFO - 预测正确条目：1980，预测错误条目：418
2025-12-03 21:28:03,706 - __main__ - INFO - 预测准确率：0.825688
2025-12-03 21:28:03,706 - __main__ - INFO - --------------------
2025-12-03 21:28:03,706 - __main__ - INFO - epoch 2 begin
2025-12-03 21:28:03,735 - __main__ - INFO - batch loss 0.419322
2025-12-03 21:28:04,669 - __main__ - INFO - batch loss 0.438825
2025-12-03 21:28:05,583 - __main__ - INFO - batch loss 0.352451
2025-12-03 21:28:05,583 - __main__ - INFO - epoch average loss: 0.409328
2025-12-03 21:28:05,584 - __main__ - INFO - 开始测试第2轮模型效果：
2025-12-03 21:28:05,774 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:28:05,774 - __main__ - INFO - 预测正确条目：2060，预测错误条目：338
2025-12-03 21:28:05,774 - __main__ - INFO - 预测准确率：0.859049
2025-12-03 21:28:05,774 - __main__ - INFO - --------------------
2025-12-03 21:28:05,775 - __main__ - INFO - epoch 3 begin
2025-12-03 21:28:05,804 - __main__ - INFO - batch loss 0.346214
2025-12-03 21:28:06,759 - __main__ - INFO - batch loss 0.405638
2025-12-03 21:28:07,768 - __main__ - INFO - batch loss 0.323151
2025-12-03 21:28:07,768 - __main__ - INFO - epoch average loss: 0.352860
2025-12-03 21:28:07,768 - __main__ - INFO - 开始测试第3轮模型效果：
2025-12-03 21:28:08,000 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:28:08,000 - __main__ - INFO - 预测正确条目：2090，预测错误条目：308
2025-12-03 21:28:08,000 - __main__ - INFO - 预测准确率：0.871560
2025-12-03 21:28:08,000 - __main__ - INFO - --------------------
2025-12-03 21:28:08,000 - __main__ - INFO - epoch 4 begin
2025-12-03 21:28:08,030 - __main__ - INFO - batch loss 0.342423
2025-12-03 21:28:08,980 - __main__ - INFO - batch loss 0.235758
2025-12-03 21:28:09,997 - __main__ - INFO - batch loss 0.377912
2025-12-03 21:28:09,997 - __main__ - INFO - epoch average loss: 0.322209
2025-12-03 21:28:09,997 - __main__ - INFO - 开始测试第4轮模型效果：
2025-12-03 21:28:10,194 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:28:10,194 - __main__ - INFO - 预测正确条目：2100，预测错误条目：298
2025-12-03 21:28:10,194 - __main__ - INFO - 预测准确率：0.875730
2025-12-03 21:28:10,194 - __main__ - INFO - --------------------
2025-12-03 21:28:10,194 - __main__ - INFO - epoch 5 begin
2025-12-03 21:28:10,220 - __main__ - INFO - batch loss 0.264921
2025-12-03 21:28:11,239 - __main__ - INFO - batch loss 0.271326
2025-12-03 21:28:12,296 - __main__ - INFO - batch loss 0.240174
2025-12-03 21:28:12,296 - __main__ - INFO - epoch average loss: 0.300420
2025-12-03 21:28:12,297 - __main__ - INFO - 开始测试第5轮模型效果：
2025-12-03 21:28:12,486 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:28:12,487 - __main__ - INFO - 预测正确条目：2117，预测错误条目：281
2025-12-03 21:28:12,487 - __main__ - INFO - 预测准确率：0.882819
2025-12-03 21:28:12,487 - __main__ - INFO - --------------------
2025-12-03 21:28:12,487 - __main__ - INFO - epoch 6 begin
2025-12-03 21:28:12,517 - __main__ - INFO - batch loss 0.267088
2025-12-03 21:28:13,476 - __main__ - INFO - batch loss 0.359132
2025-12-03 21:28:14,481 - __main__ - INFO - batch loss 0.273087
2025-12-03 21:28:14,481 - __main__ - INFO - epoch average loss: 0.284600
2025-12-03 21:28:14,481 - __main__ - INFO - 开始测试第6轮模型效果：
2025-12-03 21:28:14,660 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:28:14,660 - __main__ - INFO - 预测正确条目：2139，预测错误条目：259
2025-12-03 21:28:14,660 - __main__ - INFO - 预测准确率：0.891993
2025-12-03 21:28:14,660 - __main__ - INFO - --------------------
2025-12-03 21:28:14,661 - __main__ - INFO - epoch 7 begin
2025-12-03 21:28:14,685 - __main__ - INFO - batch loss 0.300640
2025-12-03 21:28:15,619 - __main__ - INFO - batch loss 0.203392
2025-12-03 21:28:16,602 - __main__ - INFO - batch loss 0.311390
2025-12-03 21:28:16,602 - __main__ - INFO - epoch average loss: 0.271326
2025-12-03 21:28:16,602 - __main__ - INFO - 开始测试第7轮模型效果：
2025-12-03 21:28:16,770 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:28:16,770 - __main__ - INFO - 预测正确条目：2141，预测错误条目：257
2025-12-03 21:28:16,771 - __main__ - INFO - 预测准确率：0.892827
2025-12-03 21:28:16,771 - __main__ - INFO - --------------------
2025-12-03 21:28:16,771 - __main__ - INFO - epoch 8 begin
2025-12-03 21:28:16,797 - __main__ - INFO - batch loss 0.197008
2025-12-03 21:28:17,856 - __main__ - INFO - batch loss 0.357290
2025-12-03 21:28:18,880 - __main__ - INFO - batch loss 0.247212
2025-12-03 21:28:18,880 - __main__ - INFO - epoch average loss: 0.257234
2025-12-03 21:28:18,880 - __main__ - INFO - 开始测试第8轮模型效果：
2025-12-03 21:28:19,049 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:28:19,049 - __main__ - INFO - 预测正确条目：2133，预测错误条目：265
2025-12-03 21:28:19,049 - __main__ - INFO - 预测准确率：0.889491
2025-12-03 21:28:19,049 - __main__ - INFO - --------------------
2025-12-03 21:28:19,049 - __main__ - INFO - epoch 9 begin
2025-12-03 21:28:19,074 - __main__ - INFO - batch loss 0.242825
2025-12-03 21:28:20,017 - __main__ - INFO - batch loss 0.279054
2025-12-03 21:28:21,064 - __main__ - INFO - batch loss 0.200280
2025-12-03 21:28:21,064 - __main__ - INFO - epoch average loss: 0.247776
2025-12-03 21:28:21,064 - __main__ - INFO - 开始测试第9轮模型效果：
2025-12-03 21:28:21,246 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:28:21,246 - __main__ - INFO - 预测正确条目：2143，预测错误条目：255
2025-12-03 21:28:21,246 - __main__ - INFO - 预测准确率：0.893661
2025-12-03 21:28:21,246 - __main__ - INFO - --------------------
2025-12-03 21:28:21,246 - __main__ - INFO - epoch 10 begin
2025-12-03 21:28:21,275 - __main__ - INFO - batch loss 0.263572
2025-12-03 21:28:22,239 - __main__ - INFO - batch loss 0.286867
2025-12-03 21:28:23,270 - __main__ - INFO - batch loss 0.162413
2025-12-03 21:28:23,270 - __main__ - INFO - epoch average loss: 0.239110
2025-12-03 21:28:23,271 - __main__ - INFO - 开始测试第10轮模型效果：
2025-12-03 21:28:23,486 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:28:23,486 - __main__ - INFO - 预测正确条目：2131，预测错误条目：267
2025-12-03 21:28:23,486 - __main__ - INFO - 预测准确率：0.888657
2025-12-03 21:28:23,486 - __main__ - INFO - --------------------
最后一轮准确率： 0.8886572143452878 当前配置： {'model_path': 'output', 'train_data_path': '../data/train_tag_news.json', 'valid_data_path': '../data/test_tag_news.json', 'vocab_path': 'chars.txt', 'model_type': 'gated_cnn', 'max_length': 30, 'hidden_size': 128, 'kernel_size': 3, 'num_layers': 2, 'epoch': 10, 'batch_size': 128, 'pooling_style': 'avg', 'optimizer': 'adam', 'learning_rate': 0.001, 'pretrain_model_path': 'D:\\ANACONDA\\envs\\py312\\Lib\\site-packages\\modelscope\\hub\\models\\google-bert\\bert-base-chinese', 'seed': 987, 'class_num': 18, 'vocab_size': 4622}
2025-12-03 21:28:23,869 - __main__ - INFO - epoch 1 begin
2025-12-03 21:28:23,895 - __main__ - INFO - batch loss 2.641098
2025-12-03 21:28:24,880 - __main__ - INFO - batch loss 0.389620
2025-12-03 21:28:25,910 - __main__ - INFO - batch loss 0.335595
2025-12-03 21:28:25,910 - __main__ - INFO - epoch average loss: 0.566320
2025-12-03 21:28:25,910 - __main__ - INFO - 开始测试第1轮模型效果：
2025-12-03 21:28:26,104 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:28:26,105 - __main__ - INFO - 预测正确条目：2107，预测错误条目：291
2025-12-03 21:28:26,105 - __main__ - INFO - 预测准确率：0.878649
2025-12-03 21:28:26,105 - __main__ - INFO - --------------------
2025-12-03 21:28:26,105 - __main__ - INFO - epoch 2 begin
2025-12-03 21:28:26,133 - __main__ - INFO - batch loss 0.349827
2025-12-03 21:28:27,161 - __main__ - INFO - batch loss 0.318110
2025-12-03 21:28:28,155 - __main__ - INFO - batch loss 0.282389
2025-12-03 21:28:28,155 - __main__ - INFO - epoch average loss: 0.290641
2025-12-03 21:28:28,155 - __main__ - INFO - 开始测试第2轮模型效果：
2025-12-03 21:28:28,347 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:28:28,347 - __main__ - INFO - 预测正确条目：2158，预测错误条目：240
2025-12-03 21:28:28,347 - __main__ - INFO - 预测准确率：0.899917
2025-12-03 21:28:28,347 - __main__ - INFO - --------------------
2025-12-03 21:28:28,347 - __main__ - INFO - epoch 3 begin
2025-12-03 21:28:28,378 - __main__ - INFO - batch loss 0.223622
2025-12-03 21:28:29,511 - __main__ - INFO - batch loss 0.230553
2025-12-03 21:28:30,497 - __main__ - INFO - batch loss 0.243216
2025-12-03 21:28:30,498 - __main__ - INFO - epoch average loss: 0.238215
2025-12-03 21:28:30,498 - __main__ - INFO - 开始测试第3轮模型效果：
2025-12-03 21:28:30,667 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:28:30,667 - __main__ - INFO - 预测正确条目：2138，预测错误条目：260
2025-12-03 21:28:30,667 - __main__ - INFO - 预测准确率：0.891576
2025-12-03 21:28:30,667 - __main__ - INFO - --------------------
2025-12-03 21:28:30,667 - __main__ - INFO - epoch 4 begin
2025-12-03 21:28:30,692 - __main__ - INFO - batch loss 0.222353
2025-12-03 21:28:31,728 - __main__ - INFO - batch loss 0.131723
2025-12-03 21:28:32,725 - __main__ - INFO - batch loss 0.266545
2025-12-03 21:28:32,725 - __main__ - INFO - epoch average loss: 0.192631
2025-12-03 21:28:32,725 - __main__ - INFO - 开始测试第4轮模型效果：
2025-12-03 21:28:32,982 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:28:32,982 - __main__ - INFO - 预测正确条目：2152，预测错误条目：246
2025-12-03 21:28:32,982 - __main__ - INFO - 预测准确率：0.897415
2025-12-03 21:28:32,982 - __main__ - INFO - --------------------
2025-12-03 21:28:32,983 - __main__ - INFO - epoch 5 begin
2025-12-03 21:28:33,020 - __main__ - INFO - batch loss 0.170929
2025-12-03 21:28:33,996 - __main__ - INFO - batch loss 0.257327
2025-12-03 21:28:35,018 - __main__ - INFO - batch loss 0.143767
2025-12-03 21:28:35,019 - __main__ - INFO - epoch average loss: 0.151005
2025-12-03 21:28:35,019 - __main__ - INFO - 开始测试第5轮模型效果：
2025-12-03 21:28:35,208 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:28:35,208 - __main__ - INFO - 预测正确条目：2158，预测错误条目：240
2025-12-03 21:28:35,208 - __main__ - INFO - 预测准确率：0.899917
2025-12-03 21:28:35,208 - __main__ - INFO - --------------------
2025-12-03 21:28:35,208 - __main__ - INFO - epoch 6 begin
2025-12-03 21:28:35,235 - __main__ - INFO - batch loss 0.092387
2025-12-03 21:28:36,225 - __main__ - INFO - batch loss 0.115426
2025-12-03 21:28:37,139 - __main__ - INFO - batch loss 0.098765
2025-12-03 21:28:37,139 - __main__ - INFO - epoch average loss: 0.112670
2025-12-03 21:28:37,139 - __main__ - INFO - 开始测试第6轮模型效果：
2025-12-03 21:28:37,321 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:28:37,321 - __main__ - INFO - 预测正确条目：2156，预测错误条目：242
2025-12-03 21:28:37,321 - __main__ - INFO - 预测准确率：0.899083
2025-12-03 21:28:37,321 - __main__ - INFO - --------------------
2025-12-03 21:28:37,321 - __main__ - INFO - epoch 7 begin
2025-12-03 21:28:37,347 - __main__ - INFO - batch loss 0.056613
2025-12-03 21:28:38,310 - __main__ - INFO - batch loss 0.101383
2025-12-03 21:28:39,214 - __main__ - INFO - batch loss 0.064824
2025-12-03 21:28:39,214 - __main__ - INFO - epoch average loss: 0.081482
2025-12-03 21:28:39,214 - __main__ - INFO - 开始测试第7轮模型效果：
2025-12-03 21:28:39,397 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:28:39,397 - __main__ - INFO - 预测正确条目：2146，预测错误条目：252
2025-12-03 21:28:39,397 - __main__ - INFO - 预测准确率：0.894912
2025-12-03 21:28:39,397 - __main__ - INFO - --------------------
2025-12-03 21:28:39,397 - __main__ - INFO - epoch 8 begin
2025-12-03 21:28:39,423 - __main__ - INFO - batch loss 0.039163
2025-12-03 21:28:40,355 - __main__ - INFO - batch loss 0.053487
2025-12-03 21:28:41,332 - __main__ - INFO - batch loss 0.039436
2025-12-03 21:28:41,332 - __main__ - INFO - epoch average loss: 0.057668
2025-12-03 21:28:41,332 - __main__ - INFO - 开始测试第8轮模型效果：
2025-12-03 21:28:41,530 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:28:41,531 - __main__ - INFO - 预测正确条目：2139，预测错误条目：259
2025-12-03 21:28:41,531 - __main__ - INFO - 预测准确率：0.891993
2025-12-03 21:28:41,531 - __main__ - INFO - --------------------
2025-12-03 21:28:41,531 - __main__ - INFO - epoch 9 begin
2025-12-03 21:28:41,561 - __main__ - INFO - batch loss 0.029563
2025-12-03 21:28:42,591 - __main__ - INFO - batch loss 0.037942
2025-12-03 21:28:43,605 - __main__ - INFO - batch loss 0.018641
2025-12-03 21:28:43,606 - __main__ - INFO - epoch average loss: 0.039776
2025-12-03 21:28:43,606 - __main__ - INFO - 开始测试第9轮模型效果：
2025-12-03 21:28:43,791 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:28:43,791 - __main__ - INFO - 预测正确条目：2135，预测错误条目：263
2025-12-03 21:28:43,791 - __main__ - INFO - 预测准确率：0.890325
2025-12-03 21:28:43,791 - __main__ - INFO - --------------------
2025-12-03 21:28:43,791 - __main__ - INFO - epoch 10 begin
2025-12-03 21:28:43,818 - __main__ - INFO - batch loss 0.024665
2025-12-03 21:28:44,761 - __main__ - INFO - batch loss 0.031432
2025-12-03 21:28:45,716 - __main__ - INFO - batch loss 0.065285
2025-12-03 21:28:45,717 - __main__ - INFO - epoch average loss: 0.029027
2025-12-03 21:28:45,717 - __main__ - INFO - 开始测试第10轮模型效果：
2025-12-03 21:28:45,898 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:28:45,899 - __main__ - INFO - 预测正确条目：2131，预测错误条目：267
2025-12-03 21:28:45,899 - __main__ - INFO - 预测准确率：0.888657
2025-12-03 21:28:45,899 - __main__ - INFO - --------------------
最后一轮准确率： 0.8886572143452878 当前配置： {'model_path': 'output', 'train_data_path': '../data/train_tag_news.json', 'valid_data_path': '../data/test_tag_news.json', 'vocab_path': 'chars.txt', 'model_type': 'gated_cnn', 'max_length': 30, 'hidden_size': 128, 'kernel_size': 3, 'num_layers': 2, 'epoch': 10, 'batch_size': 128, 'pooling_style': 'max', 'optimizer': 'adam', 'learning_rate': 0.001, 'pretrain_model_path': 'D:\\ANACONDA\\envs\\py312\\Lib\\site-packages\\modelscope\\hub\\models\\google-bert\\bert-base-chinese', 'seed': 987, 'class_num': 18, 'vocab_size': 4622}
learning_rate: 0.0001
hidden_size: 128
batch_size: 64
2025-12-03 21:28:46,268 - __main__ - INFO - epoch 1 begin
2025-12-03 21:28:46,286 - __main__ - INFO - batch loss 2.884444
2025-12-03 21:28:47,476 - __main__ - INFO - batch loss 2.363222
2025-12-03 21:28:48,621 - __main__ - INFO - epoch average loss: 2.310992
2025-12-03 21:28:48,622 - __main__ - INFO - 开始测试第1轮模型效果：
2025-12-03 21:28:48,816 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:28:48,816 - __main__ - INFO - 预测正确条目：1644，预测错误条目：754
2025-12-03 21:28:48,816 - __main__ - INFO - 预测准确率：0.685571
2025-12-03 21:28:48,816 - __main__ - INFO - --------------------
2025-12-03 21:28:48,816 - __main__ - INFO - epoch 2 begin
2025-12-03 21:28:48,835 - __main__ - INFO - batch loss 1.409318
2025-12-03 21:28:49,983 - __main__ - INFO - batch loss 0.794202
2025-12-03 21:28:51,133 - __main__ - INFO - epoch average loss: 1.029521
2025-12-03 21:28:51,134 - __main__ - INFO - 开始测试第2轮模型效果：
2025-12-03 21:28:51,325 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:28:51,325 - __main__ - INFO - 预测正确条目：1825，预测错误条目：573
2025-12-03 21:28:51,325 - __main__ - INFO - 预测准确率：0.761051
2025-12-03 21:28:51,325 - __main__ - INFO - --------------------
2025-12-03 21:28:51,326 - __main__ - INFO - epoch 3 begin
2025-12-03 21:28:51,341 - __main__ - INFO - batch loss 0.739881
2025-12-03 21:28:52,472 - __main__ - INFO - batch loss 0.683191
2025-12-03 21:28:53,646 - __main__ - INFO - epoch average loss: 0.674481
2025-12-03 21:28:53,646 - __main__ - INFO - 开始测试第3轮模型效果：
2025-12-03 21:28:53,847 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:28:53,849 - __main__ - INFO - 预测正确条目：1943，预测错误条目：455
2025-12-03 21:28:53,849 - __main__ - INFO - 预测准确率：0.810259
2025-12-03 21:28:53,849 - __main__ - INFO - --------------------
2025-12-03 21:28:53,849 - __main__ - INFO - epoch 4 begin
2025-12-03 21:28:53,864 - __main__ - INFO - batch loss 0.605194
2025-12-03 21:28:55,069 - __main__ - INFO - batch loss 0.562042
2025-12-03 21:28:56,260 - __main__ - INFO - epoch average loss: 0.549846
2025-12-03 21:28:56,260 - __main__ - INFO - 开始测试第4轮模型效果：
2025-12-03 21:28:56,510 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:28:56,510 - __main__ - INFO - 预测正确条目：1982，预测错误条目：416
2025-12-03 21:28:56,510 - __main__ - INFO - 预测准确率：0.826522
2025-12-03 21:28:56,510 - __main__ - INFO - --------------------
2025-12-03 21:28:56,510 - __main__ - INFO - epoch 5 begin
2025-12-03 21:28:56,529 - __main__ - INFO - batch loss 0.427544
2025-12-03 21:28:57,706 - __main__ - INFO - batch loss 0.461972
2025-12-03 21:28:58,778 - __main__ - INFO - epoch average loss: 0.486474
2025-12-03 21:28:58,778 - __main__ - INFO - 开始测试第5轮模型效果：
2025-12-03 21:28:58,958 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:28:58,958 - __main__ - INFO - 预测正确条目：2000，预测错误条目：398
2025-12-03 21:28:58,958 - __main__ - INFO - 预测准确率：0.834028
2025-12-03 21:28:58,958 - __main__ - INFO - --------------------
2025-12-03 21:28:58,958 - __main__ - INFO - epoch 6 begin
2025-12-03 21:28:58,976 - __main__ - INFO - batch loss 0.473019
2025-12-03 21:29:00,167 - __main__ - INFO - batch loss 0.489545
2025-12-03 21:29:01,375 - __main__ - INFO - epoch average loss: 0.447955
2025-12-03 21:29:01,375 - __main__ - INFO - 开始测试第6轮模型效果：
2025-12-03 21:29:01,554 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:29:01,554 - __main__ - INFO - 预测正确条目：2012，预测错误条目：386
2025-12-03 21:29:01,554 - __main__ - INFO - 预测准确率：0.839033
2025-12-03 21:29:01,554 - __main__ - INFO - --------------------
2025-12-03 21:29:01,554 - __main__ - INFO - epoch 7 begin
2025-12-03 21:29:01,569 - __main__ - INFO - batch loss 0.343069
2025-12-03 21:29:02,807 - __main__ - INFO - batch loss 0.432061
2025-12-03 21:29:03,904 - __main__ - INFO - epoch average loss: 0.422426
2025-12-03 21:29:03,904 - __main__ - INFO - 开始测试第7轮模型效果：
2025-12-03 21:29:04,084 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:29:04,084 - __main__ - INFO - 预测正确条目：2025，预测错误条目：373
2025-12-03 21:29:04,084 - __main__ - INFO - 预测准确率：0.844454
2025-12-03 21:29:04,084 - __main__ - INFO - --------------------
2025-12-03 21:29:04,085 - __main__ - INFO - epoch 8 begin
2025-12-03 21:29:04,100 - __main__ - INFO - batch loss 0.329213
2025-12-03 21:29:05,207 - __main__ - INFO - batch loss 0.375235
2025-12-03 21:29:06,452 - __main__ - INFO - epoch average loss: 0.403310
2025-12-03 21:29:06,452 - __main__ - INFO - 开始测试第8轮模型效果：
2025-12-03 21:29:06,628 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:29:06,628 - __main__ - INFO - 预测正确条目：2039，预测错误条目：359
2025-12-03 21:29:06,628 - __main__ - INFO - 预测准确率：0.850292
2025-12-03 21:29:06,628 - __main__ - INFO - --------------------
2025-12-03 21:29:06,628 - __main__ - INFO - epoch 9 begin
2025-12-03 21:29:06,646 - __main__ - INFO - batch loss 0.358335
2025-12-03 21:29:08,022 - __main__ - INFO - batch loss 0.506172
2025-12-03 21:29:09,321 - __main__ - INFO - epoch average loss: 0.389201
2025-12-03 21:29:09,321 - __main__ - INFO - 开始测试第9轮模型效果：
2025-12-03 21:29:09,508 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:29:09,508 - __main__ - INFO - 预测正确条目：2040，预测错误条目：358
2025-12-03 21:29:09,508 - __main__ - INFO - 预测准确率：0.850709
2025-12-03 21:29:09,508 - __main__ - INFO - --------------------
2025-12-03 21:29:09,508 - __main__ - INFO - epoch 10 begin
2025-12-03 21:29:09,523 - __main__ - INFO - batch loss 0.329620
2025-12-03 21:29:10,795 - __main__ - INFO - batch loss 0.296860
2025-12-03 21:29:11,937 - __main__ - INFO - epoch average loss: 0.377218
2025-12-03 21:29:11,937 - __main__ - INFO - 开始测试第10轮模型效果：
2025-12-03 21:29:12,137 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:29:12,137 - __main__ - INFO - 预测正确条目：2050，预测错误条目：348
2025-12-03 21:29:12,137 - __main__ - INFO - 预测准确率：0.854879
2025-12-03 21:29:12,137 - __main__ - INFO - --------------------
最后一轮准确率： 0.8548790658882403 当前配置： {'model_path': 'output', 'train_data_path': '../data/train_tag_news.json', 'valid_data_path': '../data/test_tag_news.json', 'vocab_path': 'chars.txt', 'model_type': 'gated_cnn', 'max_length': 30, 'hidden_size': 128, 'kernel_size': 3, 'num_layers': 2, 'epoch': 10, 'batch_size': 64, 'pooling_style': 'avg', 'optimizer': 'adam', 'learning_rate': 0.0001, 'pretrain_model_path': 'D:\\ANACONDA\\envs\\py312\\Lib\\site-packages\\modelscope\\hub\\models\\google-bert\\bert-base-chinese', 'seed': 987, 'class_num': 18, 'vocab_size': 4622}
2025-12-03 21:29:12,593 - __main__ - INFO - epoch 1 begin
2025-12-03 21:29:12,610 - __main__ - INFO - batch loss 3.145363
2025-12-03 21:29:13,783 - __main__ - INFO - batch loss 1.476637
2025-12-03 21:29:14,910 - __main__ - INFO - epoch average loss: 1.621591
2025-12-03 21:29:14,910 - __main__ - INFO - 开始测试第1轮模型效果：
2025-12-03 21:29:15,103 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:29:15,103 - __main__ - INFO - 预测正确条目：1927，预测错误条目：471
2025-12-03 21:29:15,103 - __main__ - INFO - 预测准确率：0.803586
2025-12-03 21:29:15,105 - __main__ - INFO - --------------------
2025-12-03 21:29:15,105 - __main__ - INFO - epoch 2 begin
2025-12-03 21:29:15,121 - __main__ - INFO - batch loss 0.612945
2025-12-03 21:29:16,320 - __main__ - INFO - batch loss 0.616633
2025-12-03 21:29:17,510 - __main__ - INFO - epoch average loss: 0.536442
2025-12-03 21:29:17,510 - __main__ - INFO - 开始测试第2轮模型效果：
2025-12-03 21:29:17,723 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:29:17,723 - __main__ - INFO - 预测正确条目：2003，预测错误条目：395
2025-12-03 21:29:17,724 - __main__ - INFO - 预测准确率：0.835279
2025-12-03 21:29:17,724 - __main__ - INFO - --------------------
2025-12-03 21:29:17,724 - __main__ - INFO - epoch 3 begin
2025-12-03 21:29:17,743 - __main__ - INFO - batch loss 0.530567
2025-12-03 21:29:18,889 - __main__ - INFO - batch loss 0.338572
2025-12-03 21:29:20,032 - __main__ - INFO - epoch average loss: 0.416700
2025-12-03 21:29:20,032 - __main__ - INFO - 开始测试第3轮模型效果：
2025-12-03 21:29:20,239 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:29:20,239 - __main__ - INFO - 预测正确条目：2065，预测错误条目：333
2025-12-03 21:29:20,239 - __main__ - INFO - 预测准确率：0.861134
2025-12-03 21:29:20,239 - __main__ - INFO - --------------------
2025-12-03 21:29:20,239 - __main__ - INFO - epoch 4 begin
2025-12-03 21:29:20,256 - __main__ - INFO - batch loss 0.455479
2025-12-03 21:29:21,463 - __main__ - INFO - batch loss 0.247987
2025-12-03 21:29:22,598 - __main__ - INFO - epoch average loss: 0.368876
2025-12-03 21:29:22,598 - __main__ - INFO - 开始测试第4轮模型效果：
2025-12-03 21:29:22,814 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:29:22,814 - __main__ - INFO - 预测正确条目：2090，预测错误条目：308
2025-12-03 21:29:22,814 - __main__ - INFO - 预测准确率：0.871560
2025-12-03 21:29:22,814 - __main__ - INFO - --------------------
2025-12-03 21:29:22,814 - __main__ - INFO - epoch 5 begin
2025-12-03 21:29:22,832 - __main__ - INFO - batch loss 0.290178
2025-12-03 21:29:23,993 - __main__ - INFO - batch loss 0.309806
2025-12-03 21:29:25,169 - __main__ - INFO - epoch average loss: 0.340075
2025-12-03 21:29:25,170 - __main__ - INFO - 开始测试第5轮模型效果：
2025-12-03 21:29:25,379 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:29:25,379 - __main__ - INFO - 预测正确条目：2110，预测错误条目：288
2025-12-03 21:29:25,379 - __main__ - INFO - 预测准确率：0.879900
2025-12-03 21:29:25,379 - __main__ - INFO - --------------------
2025-12-03 21:29:25,379 - __main__ - INFO - epoch 6 begin
2025-12-03 21:29:25,396 - __main__ - INFO - batch loss 0.303137
2025-12-03 21:29:26,642 - __main__ - INFO - batch loss 0.321517
2025-12-03 21:29:27,818 - __main__ - INFO - epoch average loss: 0.317912
2025-12-03 21:29:27,818 - __main__ - INFO - 开始测试第6轮模型效果：
2025-12-03 21:29:28,024 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:29:28,025 - __main__ - INFO - 预测正确条目：2121，预测错误条目：277
2025-12-03 21:29:28,025 - __main__ - INFO - 预测准确率：0.884487
2025-12-03 21:29:28,025 - __main__ - INFO - --------------------
2025-12-03 21:29:28,025 - __main__ - INFO - epoch 7 begin
2025-12-03 21:29:28,041 - __main__ - INFO - batch loss 0.290763
2025-12-03 21:29:29,246 - __main__ - INFO - batch loss 0.341806
2025-12-03 21:29:30,419 - __main__ - INFO - epoch average loss: 0.299632
2025-12-03 21:29:30,419 - __main__ - INFO - 开始测试第7轮模型效果：
2025-12-03 21:29:30,634 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:29:30,634 - __main__ - INFO - 预测正确条目：2131，预测错误条目：267
2025-12-03 21:29:30,634 - __main__ - INFO - 预测准确率：0.888657
2025-12-03 21:29:30,634 - __main__ - INFO - --------------------
2025-12-03 21:29:30,634 - __main__ - INFO - epoch 8 begin
2025-12-03 21:29:30,653 - __main__ - INFO - batch loss 0.271735
2025-12-03 21:29:31,828 - __main__ - INFO - batch loss 0.237703
2025-12-03 21:29:33,015 - __main__ - INFO - epoch average loss: 0.284109
2025-12-03 21:29:33,016 - __main__ - INFO - 开始测试第8轮模型效果：
2025-12-03 21:29:33,244 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:29:33,244 - __main__ - INFO - 预测正确条目：2138，预测错误条目：260
2025-12-03 21:29:33,244 - __main__ - INFO - 预测准确率：0.891576
2025-12-03 21:29:33,244 - __main__ - INFO - --------------------
2025-12-03 21:29:33,245 - __main__ - INFO - epoch 9 begin
2025-12-03 21:29:33,263 - __main__ - INFO - batch loss 0.313525
2025-12-03 21:29:34,436 - __main__ - INFO - batch loss 0.271077
2025-12-03 21:29:35,630 - __main__ - INFO - epoch average loss: 0.270142
2025-12-03 21:29:35,630 - __main__ - INFO - 开始测试第9轮模型效果：
2025-12-03 21:29:35,840 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:29:35,840 - __main__ - INFO - 预测正确条目：2137，预测错误条目：261
2025-12-03 21:29:35,840 - __main__ - INFO - 预测准确率：0.891159
2025-12-03 21:29:35,840 - __main__ - INFO - --------------------
2025-12-03 21:29:35,840 - __main__ - INFO - epoch 10 begin
2025-12-03 21:29:35,859 - __main__ - INFO - batch loss 0.301968
2025-12-03 21:29:37,059 - __main__ - INFO - batch loss 0.321056
2025-12-03 21:29:38,233 - __main__ - INFO - epoch average loss: 0.257290
2025-12-03 21:29:38,234 - __main__ - INFO - 开始测试第10轮模型效果：
2025-12-03 21:29:38,458 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:29:38,459 - __main__ - INFO - 预测正确条目：2146，预测错误条目：252
2025-12-03 21:29:38,459 - __main__ - INFO - 预测准确率：0.894912
2025-12-03 21:29:38,459 - __main__ - INFO - --------------------
最后一轮准确率： 0.8949124270225187 当前配置： {'model_path': 'output', 'train_data_path': '../data/train_tag_news.json', 'valid_data_path': '../data/test_tag_news.json', 'vocab_path': 'chars.txt', 'model_type': 'gated_cnn', 'max_length': 30, 'hidden_size': 128, 'kernel_size': 3, 'num_layers': 2, 'epoch': 10, 'batch_size': 64, 'pooling_style': 'max', 'optimizer': 'adam', 'learning_rate': 0.0001, 'pretrain_model_path': 'D:\\ANACONDA\\envs\\py312\\Lib\\site-packages\\modelscope\\hub\\models\\google-bert\\bert-base-chinese', 'seed': 987, 'class_num': 18, 'vocab_size': 4622}
batch_size: 128
2025-12-03 21:29:38,894 - __main__ - INFO - epoch 1 begin
2025-12-03 21:29:38,927 - __main__ - INFO - batch loss 2.897580
2025-12-03 21:29:39,903 - __main__ - INFO - batch loss 2.688203
2025-12-03 21:29:40,895 - __main__ - INFO - batch loss 2.342735
2025-12-03 21:29:40,896 - __main__ - INFO - epoch average loss: 2.657950
2025-12-03 21:29:40,896 - __main__ - INFO - 开始测试第1轮模型效果：
2025-12-03 21:29:41,071 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:29:41,071 - __main__ - INFO - 预测正确条目：1641，预测错误条目：757
2025-12-03 21:29:41,071 - __main__ - INFO - 预测准确率：0.684320
2025-12-03 21:29:41,071 - __main__ - INFO - --------------------
2025-12-03 21:29:41,071 - __main__ - INFO - epoch 2 begin
2025-12-03 21:29:41,089 - __main__ - INFO - batch loss 2.307732
2025-12-03 21:29:42,082 - __main__ - INFO - batch loss 1.880703
2025-12-03 21:29:43,041 - __main__ - INFO - batch loss 1.404256
2025-12-03 21:29:43,041 - __main__ - INFO - epoch average loss: 1.852707
2025-12-03 21:29:43,041 - __main__ - INFO - 开始测试第2轮模型效果：
2025-12-03 21:29:43,221 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:29:43,222 - __main__ - INFO - 预测正确条目：1635，预测错误条目：763
2025-12-03 21:29:43,222 - __main__ - INFO - 预测准确率：0.681818
2025-12-03 21:29:43,222 - __main__ - INFO - --------------------
2025-12-03 21:29:43,222 - __main__ - INFO - epoch 3 begin
2025-12-03 21:29:43,254 - __main__ - INFO - batch loss 1.386783
2025-12-03 21:29:44,233 - __main__ - INFO - batch loss 1.065117
2025-12-03 21:29:45,208 - __main__ - INFO - batch loss 0.978516
2025-12-03 21:29:45,208 - __main__ - INFO - epoch average loss: 1.142361
2025-12-03 21:29:45,208 - __main__ - INFO - 开始测试第3轮模型效果：
2025-12-03 21:29:45,397 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:29:45,397 - __main__ - INFO - 预测正确条目：1721，预测错误条目：677
2025-12-03 21:29:45,397 - __main__ - INFO - 预测准确率：0.717681
2025-12-03 21:29:45,397 - __main__ - INFO - --------------------
2025-12-03 21:29:45,397 - __main__ - INFO - epoch 4 begin
2025-12-03 21:29:45,426 - __main__ - INFO - batch loss 1.054514
2025-12-03 21:29:46,471 - __main__ - INFO - batch loss 0.698708
2025-12-03 21:29:47,445 - __main__ - INFO - batch loss 0.674056
2025-12-03 21:29:47,445 - __main__ - INFO - epoch average loss: 0.846633
2025-12-03 21:29:47,445 - __main__ - INFO - 开始测试第4轮模型效果：
2025-12-03 21:29:47,624 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:29:47,624 - __main__ - INFO - 预测正确条目：1855，预测错误条目：543
2025-12-03 21:29:47,624 - __main__ - INFO - 预测准确率：0.773561
2025-12-03 21:29:47,624 - __main__ - INFO - --------------------
2025-12-03 21:29:47,624 - __main__ - INFO - epoch 5 begin
2025-12-03 21:29:47,655 - __main__ - INFO - batch loss 0.808130
2025-12-03 21:29:48,642 - __main__ - INFO - batch loss 0.740720
2025-12-03 21:29:49,540 - __main__ - INFO - batch loss 0.614516
2025-12-03 21:29:49,541 - __main__ - INFO - epoch average loss: 0.699739
2025-12-03 21:29:49,541 - __main__ - INFO - 开始测试第5轮模型效果：
2025-12-03 21:29:49,721 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:29:49,721 - __main__ - INFO - 预测正确条目：1921，预测错误条目：477
2025-12-03 21:29:49,721 - __main__ - INFO - 预测准确率：0.801084
2025-12-03 21:29:49,722 - __main__ - INFO - --------------------
2025-12-03 21:29:49,722 - __main__ - INFO - epoch 6 begin
2025-12-03 21:29:49,748 - __main__ - INFO - batch loss 0.641030
2025-12-03 21:29:50,672 - __main__ - INFO - batch loss 0.675336
2025-12-03 21:29:51,588 - __main__ - INFO - batch loss 0.627481
2025-12-03 21:29:51,589 - __main__ - INFO - epoch average loss: 0.611544
2025-12-03 21:29:51,589 - __main__ - INFO - 开始测试第6轮模型效果：
2025-12-03 21:29:51,766 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:29:51,766 - __main__ - INFO - 预测正确条目：1950，预测错误条目：448
2025-12-03 21:29:51,766 - __main__ - INFO - 预测准确率：0.813178
2025-12-03 21:29:51,766 - __main__ - INFO - --------------------
2025-12-03 21:29:51,766 - __main__ - INFO - epoch 7 begin
2025-12-03 21:29:51,795 - __main__ - INFO - batch loss 0.658963
2025-12-03 21:29:52,801 - __main__ - INFO - batch loss 0.522470
2025-12-03 21:29:53,774 - __main__ - INFO - batch loss 0.557640
2025-12-03 21:29:53,774 - __main__ - INFO - epoch average loss: 0.553051
2025-12-03 21:29:53,774 - __main__ - INFO - 开始测试第7轮模型效果：
2025-12-03 21:29:53,946 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:29:53,946 - __main__ - INFO - 预测正确条目：1966，预测错误条目：432
2025-12-03 21:29:53,946 - __main__ - INFO - 预测准确率：0.819850
2025-12-03 21:29:53,946 - __main__ - INFO - --------------------
2025-12-03 21:29:53,946 - __main__ - INFO - epoch 8 begin
2025-12-03 21:29:53,974 - __main__ - INFO - batch loss 0.424490
2025-12-03 21:29:54,934 - __main__ - INFO - batch loss 0.520563
2025-12-03 21:29:55,937 - __main__ - INFO - batch loss 0.544709
2025-12-03 21:29:55,937 - __main__ - INFO - epoch average loss: 0.511553
2025-12-03 21:29:55,937 - __main__ - INFO - 开始测试第8轮模型效果：
2025-12-03 21:29:56,125 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:29:56,125 - __main__ - INFO - 预测正确条目：1980，预测错误条目：418
2025-12-03 21:29:56,125 - __main__ - INFO - 预测准确率：0.825688
2025-12-03 21:29:56,125 - __main__ - INFO - --------------------
2025-12-03 21:29:56,125 - __main__ - INFO - epoch 9 begin
2025-12-03 21:29:56,156 - __main__ - INFO - batch loss 0.455175
2025-12-03 21:29:57,107 - __main__ - INFO - batch loss 0.452535
2025-12-03 21:29:58,119 - __main__ - INFO - batch loss 0.505480
2025-12-03 21:29:58,119 - __main__ - INFO - epoch average loss: 0.481117
2025-12-03 21:29:58,119 - __main__ - INFO - 开始测试第9轮模型效果：
2025-12-03 21:29:58,306 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:29:58,306 - __main__ - INFO - 预测正确条目：2005，预测错误条目：393
2025-12-03 21:29:58,307 - __main__ - INFO - 预测准确率：0.836113
2025-12-03 21:29:58,307 - __main__ - INFO - --------------------
2025-12-03 21:29:58,307 - __main__ - INFO - epoch 10 begin
2025-12-03 21:29:58,333 - __main__ - INFO - batch loss 0.463476
2025-12-03 21:29:59,291 - __main__ - INFO - batch loss 0.409425
2025-12-03 21:30:00,253 - __main__ - INFO - batch loss 0.408339
2025-12-03 21:30:00,253 - __main__ - INFO - epoch average loss: 0.457140
2025-12-03 21:30:00,253 - __main__ - INFO - 开始测试第10轮模型效果：
2025-12-03 21:30:00,419 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:30:00,419 - __main__ - INFO - 预测正确条目：2017，预测错误条目：381
2025-12-03 21:30:00,419 - __main__ - INFO - 预测准确率：0.841118
2025-12-03 21:30:00,419 - __main__ - INFO - --------------------
最后一轮准确率： 0.841117597998332 当前配置： {'model_path': 'output', 'train_data_path': '../data/train_tag_news.json', 'valid_data_path': '../data/test_tag_news.json', 'vocab_path': 'chars.txt', 'model_type': 'gated_cnn', 'max_length': 30, 'hidden_size': 128, 'kernel_size': 3, 'num_layers': 2, 'epoch': 10, 'batch_size': 128, 'pooling_style': 'avg', 'optimizer': 'adam', 'learning_rate': 0.0001, 'pretrain_model_path': 'D:\\ANACONDA\\envs\\py312\\Lib\\site-packages\\modelscope\\hub\\models\\google-bert\\bert-base-chinese', 'seed': 987, 'class_num': 18, 'vocab_size': 4622}
2025-12-03 21:30:00,920 - __main__ - INFO - epoch 1 begin
2025-12-03 21:30:00,943 - __main__ - INFO - batch loss 3.027880
2025-12-03 21:30:01,968 - __main__ - INFO - batch loss 2.073860
2025-12-03 21:30:02,914 - __main__ - INFO - batch loss 1.327803
2025-12-03 21:30:02,914 - __main__ - INFO - epoch average loss: 2.099203
2025-12-03 21:30:02,915 - __main__ - INFO - 开始测试第1轮模型效果：
2025-12-03 21:30:03,092 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:30:03,093 - __main__ - INFO - 预测正确条目：1759，预测错误条目：639
2025-12-03 21:30:03,093 - __main__ - INFO - 预测准确率：0.733528
2025-12-03 21:30:03,093 - __main__ - INFO - --------------------
2025-12-03 21:30:03,093 - __main__ - INFO - epoch 2 begin
2025-12-03 21:30:03,117 - __main__ - INFO - batch loss 1.285727
2025-12-03 21:30:04,030 - __main__ - INFO - batch loss 0.809025
2025-12-03 21:30:04,941 - __main__ - INFO - batch loss 0.598385
2025-12-03 21:30:04,942 - __main__ - INFO - epoch average loss: 0.827883
2025-12-03 21:30:04,942 - __main__ - INFO - 开始测试第2轮模型效果：
2025-12-03 21:30:05,121 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:30:05,122 - __main__ - INFO - 预测正确条目：1949，预测错误条目：449
2025-12-03 21:30:05,122 - __main__ - INFO - 预测准确率：0.812761
2025-12-03 21:30:05,122 - __main__ - INFO - --------------------
2025-12-03 21:30:05,122 - __main__ - INFO - epoch 3 begin
2025-12-03 21:30:05,147 - __main__ - INFO - batch loss 0.612531
2025-12-03 21:30:06,051 - __main__ - INFO - batch loss 0.437873
2025-12-03 21:30:06,968 - __main__ - INFO - batch loss 0.425906
2025-12-03 21:30:06,968 - __main__ - INFO - epoch average loss: 0.523586
2025-12-03 21:30:06,968 - __main__ - INFO - 开始测试第3轮模型效果：
2025-12-03 21:30:07,147 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:30:07,147 - __main__ - INFO - 预测正确条目：2013，预测错误条目：385
2025-12-03 21:30:07,147 - __main__ - INFO - 预测准确率：0.839450
2025-12-03 21:30:07,147 - __main__ - INFO - --------------------
2025-12-03 21:30:07,147 - __main__ - INFO - epoch 4 begin
2025-12-03 21:30:07,172 - __main__ - INFO - batch loss 0.436813
2025-12-03 21:30:08,090 - __main__ - INFO - batch loss 0.425251
2025-12-03 21:30:08,987 - __main__ - INFO - batch loss 0.431565
2025-12-03 21:30:08,988 - __main__ - INFO - epoch average loss: 0.440090
2025-12-03 21:30:08,988 - __main__ - INFO - 开始测试第4轮模型效果：
2025-12-03 21:30:09,165 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:30:09,166 - __main__ - INFO - 预测正确条目：2043，预测错误条目：355
2025-12-03 21:30:09,166 - __main__ - INFO - 预测准确率：0.851960
2025-12-03 21:30:09,166 - __main__ - INFO - --------------------
2025-12-03 21:30:09,166 - __main__ - INFO - epoch 5 begin
2025-12-03 21:30:09,191 - __main__ - INFO - batch loss 0.404668
2025-12-03 21:30:10,113 - __main__ - INFO - batch loss 0.349286
2025-12-03 21:30:11,016 - __main__ - INFO - batch loss 0.335042
2025-12-03 21:30:11,016 - __main__ - INFO - epoch average loss: 0.397633
2025-12-03 21:30:11,017 - __main__ - INFO - 开始测试第5轮模型效果：
2025-12-03 21:30:11,192 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:30:11,192 - __main__ - INFO - 预测正确条目：2061，预测错误条目：337
2025-12-03 21:30:11,192 - __main__ - INFO - 预测准确率：0.859466
2025-12-03 21:30:11,192 - __main__ - INFO - --------------------
2025-12-03 21:30:11,193 - __main__ - INFO - epoch 6 begin
2025-12-03 21:30:11,217 - __main__ - INFO - batch loss 0.331059
2025-12-03 21:30:12,130 - __main__ - INFO - batch loss 0.293270
2025-12-03 21:30:13,051 - __main__ - INFO - batch loss 0.337413
2025-12-03 21:30:13,052 - __main__ - INFO - epoch average loss: 0.369804
2025-12-03 21:30:13,052 - __main__ - INFO - 开始测试第6轮模型效果：
2025-12-03 21:30:13,229 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:30:13,229 - __main__ - INFO - 预测正确条目：2076，预测错误条目：322
2025-12-03 21:30:13,230 - __main__ - INFO - 预测准确率：0.865721
2025-12-03 21:30:13,230 - __main__ - INFO - --------------------
2025-12-03 21:30:13,230 - __main__ - INFO - epoch 7 begin
2025-12-03 21:30:13,256 - __main__ - INFO - batch loss 0.317487
2025-12-03 21:30:14,177 - __main__ - INFO - batch loss 0.338763
2025-12-03 21:30:15,092 - __main__ - INFO - batch loss 0.432629
2025-12-03 21:30:15,092 - __main__ - INFO - epoch average loss: 0.349155
2025-12-03 21:30:15,092 - __main__ - INFO - 开始测试第7轮模型效果：
2025-12-03 21:30:15,271 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:30:15,271 - __main__ - INFO - 预测正确条目：2095，预测错误条目：303
2025-12-03 21:30:15,271 - __main__ - INFO - 预测准确率：0.873645
2025-12-03 21:30:15,271 - __main__ - INFO - --------------------
2025-12-03 21:30:15,271 - __main__ - INFO - epoch 8 begin
2025-12-03 21:30:15,297 - __main__ - INFO - batch loss 0.313777
2025-12-03 21:30:16,214 - __main__ - INFO - batch loss 0.342063
2025-12-03 21:30:17,130 - __main__ - INFO - batch loss 0.297999
2025-12-03 21:30:17,131 - __main__ - INFO - epoch average loss: 0.332109
2025-12-03 21:30:17,131 - __main__ - INFO - 开始测试第8轮模型效果：
2025-12-03 21:30:17,309 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:30:17,309 - __main__ - INFO - 预测正确条目：2105，预测错误条目：293
2025-12-03 21:30:17,309 - __main__ - INFO - 预测准确率：0.877815
2025-12-03 21:30:17,309 - __main__ - INFO - --------------------
2025-12-03 21:30:17,309 - __main__ - INFO - epoch 9 begin
2025-12-03 21:30:17,333 - __main__ - INFO - batch loss 0.362308
2025-12-03 21:30:18,259 - __main__ - INFO - batch loss 0.326874
2025-12-03 21:30:19,227 - __main__ - INFO - batch loss 0.263867
2025-12-03 21:30:19,228 - __main__ - INFO - epoch average loss: 0.317835
2025-12-03 21:30:19,228 - __main__ - INFO - 开始测试第9轮模型效果：
2025-12-03 21:30:19,431 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:30:19,431 - __main__ - INFO - 预测正确条目：2115，预测错误条目：283
2025-12-03 21:30:19,431 - __main__ - INFO - 预测准确率：0.881985
2025-12-03 21:30:19,431 - __main__ - INFO - --------------------
2025-12-03 21:30:19,431 - __main__ - INFO - epoch 10 begin
2025-12-03 21:30:19,462 - __main__ - INFO - batch loss 0.244674
2025-12-03 21:30:20,443 - __main__ - INFO - batch loss 0.351227
2025-12-03 21:30:21,433 - __main__ - INFO - batch loss 0.277849
2025-12-03 21:30:21,434 - __main__ - INFO - epoch average loss: 0.305357
2025-12-03 21:30:21,434 - __main__ - INFO - 开始测试第10轮模型效果：
2025-12-03 21:30:21,621 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:30:21,621 - __main__ - INFO - 预测正确条目：2122，预测错误条目：276
2025-12-03 21:30:21,621 - __main__ - INFO - 预测准确率：0.884904
2025-12-03 21:30:21,621 - __main__ - INFO - --------------------
最后一轮准确率： 0.8849040867389492 当前配置： {'model_path': 'output', 'train_data_path': '../data/train_tag_news.json', 'valid_data_path': '../data/test_tag_news.json', 'vocab_path': 'chars.txt', 'model_type': 'gated_cnn', 'max_length': 30, 'hidden_size': 128, 'kernel_size': 3, 'num_layers': 2, 'epoch': 10, 'batch_size': 128, 'pooling_style': 'max', 'optimizer': 'adam', 'learning_rate': 0.0001, 'pretrain_model_path': 'D:\\ANACONDA\\envs\\py312\\Lib\\site-packages\\modelscope\\hub\\models\\google-bert\\bert-base-chinese', 'seed': 987, 'class_num': 18, 'vocab_size': 4622}
model_name: bert
learning_rate: 0.001
hidden_size: 128
batch_size: 64
2025-12-03 21:30:26,772 - __main__ - INFO - epoch 1 begin
We strongly recommend passing in an `attention_mask` since your input_ids may be padded. See https://huggingface.co/docs/transformers/troubleshooting#incorrect-output-when-padding-tokens-arent-masked.
2025-12-03 21:30:34,328 - __main__ - INFO - batch loss 3.025540
2025-12-03 21:39:29,235 - __main__ - INFO - batch loss 0.686610
2025-12-03 21:47:35,134 - __main__ - INFO - epoch average loss: 0.764359
2025-12-03 21:47:35,134 - __main__ - INFO - 开始测试第1轮模型效果：
2025-12-03 21:48:46,805 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 21:48:46,806 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-03 21:48:46,806 - __main__ - INFO - 预测准确率：0.664721
2025-12-03 21:48:46,806 - __main__ - INFO - --------------------
2025-12-03 21:48:46,808 - __main__ - INFO - epoch 2 begin
2025-12-03 21:48:53,379 - __main__ - INFO - batch loss 0.546832
2025-12-03 21:57:10,455 - __main__ - INFO - batch loss 0.556604
2025-12-03 22:05:23,247 - __main__ - INFO - epoch average loss: 0.645302
2025-12-03 22:05:23,247 - __main__ - INFO - 开始测试第2轮模型效果：
2025-12-03 22:06:34,993 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 22:06:34,994 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-03 22:06:34,994 - __main__ - INFO - 预测准确率：0.664721
2025-12-03 22:06:34,994 - __main__ - INFO - --------------------
2025-12-03 22:06:34,996 - __main__ - INFO - epoch 3 begin
2025-12-03 22:06:41,539 - __main__ - INFO - batch loss 0.681550
2025-12-03 22:14:57,877 - __main__ - INFO - batch loss 0.677791
2025-12-03 22:22:55,423 - __main__ - INFO - epoch average loss: 0.646131
2025-12-03 22:22:55,423 - __main__ - INFO - 开始测试第3轮模型效果：
2025-12-03 22:24:08,648 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 22:24:08,648 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-03 22:24:08,648 - __main__ - INFO - 预测准确率：0.664721
2025-12-03 22:24:08,648 - __main__ - INFO - --------------------
2025-12-03 22:24:08,649 - __main__ - INFO - epoch 4 begin
2025-12-03 22:24:15,367 - __main__ - INFO - batch loss 0.662173
2025-12-03 22:32:30,989 - __main__ - INFO - batch loss 0.678844
2025-12-03 22:40:36,940 - __main__ - INFO - epoch average loss: 0.647102
2025-12-03 22:40:36,940 - __main__ - INFO - 开始测试第4轮模型效果：
2025-12-03 22:41:49,434 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 22:41:49,434 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-03 22:41:49,434 - __main__ - INFO - 预测准确率：0.664721
2025-12-03 22:41:49,434 - __main__ - INFO - --------------------
2025-12-03 22:41:49,436 - __main__ - INFO - epoch 5 begin
2025-12-03 22:41:56,114 - __main__ - INFO - batch loss 0.534378
2025-12-03 22:50:12,081 - __main__ - INFO - batch loss 0.599043
2025-12-03 22:58:16,862 - __main__ - INFO - epoch average loss: 0.641821
2025-12-03 22:58:16,862 - __main__ - INFO - 开始测试第5轮模型效果：
2025-12-03 22:59:29,562 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 22:59:29,562 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-03 22:59:29,563 - __main__ - INFO - 预测准确率：0.664721
2025-12-03 22:59:29,563 - __main__ - INFO - --------------------
2025-12-03 22:59:29,564 - __main__ - INFO - epoch 6 begin
2025-12-03 22:59:36,214 - __main__ - INFO - batch loss 0.620036
2025-12-03 23:07:50,654 - __main__ - INFO - batch loss 0.622187
2025-12-03 23:15:56,037 - __main__ - INFO - epoch average loss: 0.641866
2025-12-03 23:15:56,037 - __main__ - INFO - 开始测试第6轮模型效果：
2025-12-03 23:17:08,566 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 23:17:08,567 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-03 23:17:08,567 - __main__ - INFO - 预测准确率：0.664721
2025-12-03 23:17:08,567 - __main__ - INFO - --------------------
2025-12-03 23:17:08,568 - __main__ - INFO - epoch 7 begin
2025-12-03 23:17:15,153 - __main__ - INFO - batch loss 0.585650
2025-12-03 23:25:28,269 - __main__ - INFO - batch loss 0.663389
2025-12-03 23:33:33,994 - __main__ - INFO - epoch average loss: 0.640870
2025-12-03 23:33:33,994 - __main__ - INFO - 开始测试第7轮模型效果：
2025-12-03 23:34:44,772 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 23:34:44,772 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-03 23:34:44,772 - __main__ - INFO - 预测准确率：0.664721
2025-12-03 23:34:44,772 - __main__ - INFO - --------------------
2025-12-03 23:34:44,774 - __main__ - INFO - epoch 8 begin
2025-12-03 23:34:51,233 - __main__ - INFO - batch loss 0.644465
2025-12-03 23:42:58,849 - __main__ - INFO - batch loss 0.742304
2025-12-03 23:51:01,309 - __main__ - INFO - epoch average loss: 0.642259
2025-12-03 23:51:01,309 - __main__ - INFO - 开始测试第8轮模型效果：
2025-12-03 23:52:11,355 - __main__ - INFO - 预测集合条目总量：2398
2025-12-03 23:52:11,355 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-03 23:52:11,355 - __main__ - INFO - 预测准确率：0.664721
2025-12-03 23:52:11,355 - __main__ - INFO - --------------------
2025-12-03 23:52:11,356 - __main__ - INFO - epoch 9 begin
2025-12-03 23:52:17,671 - __main__ - INFO - batch loss 0.663368
2025-12-04 00:00:30,330 - __main__ - INFO - batch loss 0.634099
2025-12-04 00:08:39,135 - __main__ - INFO - epoch average loss: 0.639057
2025-12-04 00:08:39,135 - __main__ - INFO - 开始测试第9轮模型效果：
2025-12-04 00:09:52,056 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 00:09:52,056 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 00:09:52,056 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 00:09:52,056 - __main__ - INFO - --------------------
2025-12-04 00:09:52,058 - __main__ - INFO - epoch 10 begin
2025-12-04 00:09:58,603 - __main__ - INFO - batch loss 0.657135
2025-12-04 00:18:10,314 - __main__ - INFO - batch loss 0.605850
2025-12-04 07:40:54,498 - __main__ - INFO - epoch average loss: 0.638225
2025-12-04 07:40:54,498 - __main__ - INFO - 开始测试第10轮模型效果：
2025-12-04 07:42:05,044 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 07:42:05,044 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 07:42:05,044 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 07:42:05,044 - __main__ - INFO - --------------------
最后一轮准确率： 0.664720600500417 当前配置： {'model_path': 'output', 'train_data_path': '../data/train_tag_news.json', 'valid_data_path': '../data/test_tag_news.json', 'vocab_path': 'chars.txt', 'model_type': 'bert', 'max_length': 30, 'hidden_size': 128, 'kernel_size': 3, 'num_layers': 2, 'epoch': 10, 'batch_size': 64, 'pooling_style': 'avg', 'optimizer': 'adam', 'learning_rate': 0.001, 'pretrain_model_path': 'D:\\ANACONDA\\envs\\py312\\Lib\\site-packages\\modelscope\\hub\\models\\google-bert\\bert-base-chinese', 'seed': 987, 'class_num': 18, 'vocab_size': 4622}
2025-12-04 07:42:09,428 - __main__ - INFO - epoch 1 begin
2025-12-04 07:42:16,499 - __main__ - INFO - batch loss 3.490870
2025-12-04 07:50:27,975 - __main__ - INFO - batch loss 0.584957
2025-12-04 07:58:36,963 - __main__ - INFO - epoch average loss: 0.731708
2025-12-04 07:58:36,963 - __main__ - INFO - 开始测试第1轮模型效果：
2025-12-04 07:59:49,925 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 07:59:49,925 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 07:59:49,925 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 07:59:49,925 - __main__ - INFO - --------------------
2025-12-04 07:59:49,926 - __main__ - INFO - epoch 2 begin
2025-12-04 07:59:56,950 - __main__ - INFO - batch loss 0.614108
2025-12-04 08:08:12,554 - __main__ - INFO - batch loss 0.617985
2025-12-04 08:16:23,636 - __main__ - INFO - epoch average loss: 0.646605
2025-12-04 08:16:23,637 - __main__ - INFO - 开始测试第2轮模型效果：
2025-12-04 08:17:36,778 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 08:17:36,778 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 08:17:36,778 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 08:17:36,778 - __main__ - INFO - --------------------
2025-12-04 08:17:36,780 - __main__ - INFO - epoch 3 begin
2025-12-04 08:17:43,446 - __main__ - INFO - batch loss 0.666998
2025-12-04 08:26:00,359 - __main__ - INFO - batch loss 0.686879
2025-12-04 08:34:06,778 - __main__ - INFO - epoch average loss: 0.642935
2025-12-04 08:34:06,778 - __main__ - INFO - 开始测试第3轮模型效果：
2025-12-04 08:35:19,566 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 08:35:19,566 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 08:35:19,566 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 08:35:19,566 - __main__ - INFO - --------------------
2025-12-04 08:35:19,568 - __main__ - INFO - epoch 4 begin
2025-12-04 08:35:26,216 - __main__ - INFO - batch loss 0.655992
2025-12-04 08:43:40,960 - __main__ - INFO - batch loss 0.625419
2025-12-04 08:51:48,505 - __main__ - INFO - epoch average loss: 0.642553
2025-12-04 08:51:48,505 - __main__ - INFO - 开始测试第4轮模型效果：
2025-12-04 08:53:02,068 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 08:53:02,068 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 08:53:02,068 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 08:53:02,068 - __main__ - INFO - --------------------
2025-12-04 08:53:02,069 - __main__ - INFO - epoch 5 begin
2025-12-04 08:53:08,770 - __main__ - INFO - batch loss 0.666199
2025-12-04 09:01:23,723 - __main__ - INFO - batch loss 0.607151
2025-12-04 09:09:31,048 - __main__ - INFO - epoch average loss: 0.642899
2025-12-04 09:09:31,048 - __main__ - INFO - 开始测试第5轮模型效果：
2025-12-04 09:10:44,226 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 09:10:44,226 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 09:10:44,226 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 09:10:44,226 - __main__ - INFO - --------------------
2025-12-04 09:10:44,228 - __main__ - INFO - epoch 6 begin
2025-12-04 09:10:50,937 - __main__ - INFO - batch loss 0.652301
2025-12-04 09:19:06,167 - __main__ - INFO - batch loss 0.691953
2025-12-04 09:27:12,761 - __main__ - INFO - epoch average loss: 0.640438
2025-12-04 09:27:12,761 - __main__ - INFO - 开始测试第6轮模型效果：
2025-12-04 09:28:25,714 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 09:28:25,714 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 09:28:25,714 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 09:28:25,714 - __main__ - INFO - --------------------
2025-12-04 09:28:25,716 - __main__ - INFO - epoch 7 begin
2025-12-04 09:28:32,390 - __main__ - INFO - batch loss 0.652443
2025-12-04 09:36:47,132 - __main__ - INFO - batch loss 0.649436
2025-12-04 09:44:54,171 - __main__ - INFO - epoch average loss: 0.641700
2025-12-04 09:44:54,171 - __main__ - INFO - 开始测试第7轮模型效果：
2025-12-04 09:46:07,546 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 09:46:07,546 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 09:46:07,546 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 09:46:07,546 - __main__ - INFO - --------------------
2025-12-04 09:46:07,548 - __main__ - INFO - epoch 8 begin
2025-12-04 09:46:14,124 - __main__ - INFO - batch loss 0.584115
2025-12-04 09:54:29,819 - __main__ - INFO - batch loss 0.706610
2025-12-04 10:02:46,509 - __main__ - INFO - epoch average loss: 0.640922
2025-12-04 10:02:46,509 - __main__ - INFO - 开始测试第8轮模型效果：
2025-12-04 10:04:01,111 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 10:04:01,111 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 10:04:01,111 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 10:04:01,111 - __main__ - INFO - --------------------
2025-12-04 10:04:01,113 - __main__ - INFO - epoch 9 begin
2025-12-04 10:04:07,968 - __main__ - INFO - batch loss 0.696951
2025-12-04 10:12:23,351 - __main__ - INFO - batch loss 0.679762
2025-12-04 10:20:28,815 - __main__ - INFO - epoch average loss: 0.643095
2025-12-04 10:20:28,815 - __main__ - INFO - 开始测试第9轮模型效果：
2025-12-04 10:21:42,209 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 10:21:42,209 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 10:21:42,209 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 10:21:42,209 - __main__ - INFO - --------------------
2025-12-04 10:21:42,211 - __main__ - INFO - epoch 10 begin
2025-12-04 10:21:48,795 - __main__ - INFO - batch loss 0.638418
2025-12-04 10:30:04,807 - __main__ - INFO - batch loss 0.674329
2025-12-04 10:38:13,965 - __main__ - INFO - epoch average loss: 0.639514
2025-12-04 10:38:13,966 - __main__ - INFO - 开始测试第10轮模型效果：
2025-12-04 10:39:27,071 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 10:39:27,071 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 10:39:27,071 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 10:39:27,071 - __main__ - INFO - --------------------
最后一轮准确率： 0.664720600500417 当前配置： {'model_path': 'output', 'train_data_path': '../data/train_tag_news.json', 'valid_data_path': '../data/test_tag_news.json', 'vocab_path': 'chars.txt', 'model_type': 'bert', 'max_length': 30, 'hidden_size': 128, 'kernel_size': 3, 'num_layers': 2, 'epoch': 10, 'batch_size': 64, 'pooling_style': 'max', 'optimizer': 'adam', 'learning_rate': 0.001, 'pretrain_model_path': 'D:\\ANACONDA\\envs\\py312\\Lib\\site-packages\\modelscope\\hub\\models\\google-bert\\bert-base-chinese', 'seed': 987, 'class_num': 18, 'vocab_size': 4622}
batch_size: 128
2025-12-04 10:39:31,583 - __main__ - INFO - epoch 1 begin
2025-12-04 10:39:44,642 - __main__ - INFO - batch loss 2.420278
2025-12-04 10:47:34,394 - __main__ - INFO - batch loss 0.638792
2025-12-04 10:55:17,751 - __main__ - INFO - batch loss 0.650064
2025-12-04 10:55:17,751 - __main__ - INFO - epoch average loss: 1.399703
2025-12-04 10:55:17,751 - __main__ - INFO - 开始测试第1轮模型效果：
2025-12-04 10:56:30,010 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 10:56:30,010 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 10:56:30,010 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 10:56:30,011 - __main__ - INFO - --------------------
2025-12-04 10:56:30,012 - __main__ - INFO - epoch 2 begin
2025-12-04 10:56:42,891 - __main__ - INFO - batch loss 0.680765
2025-12-04 11:04:30,399 - __main__ - INFO - batch loss 0.666369
2025-12-04 11:12:12,874 - __main__ - INFO - batch loss 0.631405
2025-12-04 11:12:12,874 - __main__ - INFO - epoch average loss: 0.638812
2025-12-04 11:12:12,874 - __main__ - INFO - 开始测试第2轮模型效果：
2025-12-04 11:13:25,004 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 11:13:25,004 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 11:13:25,004 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 11:13:25,004 - __main__ - INFO - --------------------
2025-12-04 11:13:25,006 - __main__ - INFO - epoch 3 begin
2025-12-04 11:13:37,954 - __main__ - INFO - batch loss 0.687467
2025-12-04 11:21:25,462 - __main__ - INFO - batch loss 0.659282
2025-12-04 11:29:13,176 - __main__ - INFO - batch loss 0.681144
2025-12-04 11:29:13,177 - __main__ - INFO - epoch average loss: 0.647232
2025-12-04 11:29:13,177 - __main__ - INFO - 开始测试第3轮模型效果：
2025-12-04 11:30:25,091 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 11:30:25,091 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 11:30:25,092 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 11:30:25,092 - __main__ - INFO - --------------------
2025-12-04 11:30:25,093 - __main__ - INFO - epoch 4 begin
2025-12-04 11:30:37,888 - __main__ - INFO - batch loss 0.629218
2025-12-04 11:38:25,763 - __main__ - INFO - batch loss 0.655080
2025-12-04 11:46:14,660 - __main__ - INFO - batch loss 0.552739
2025-12-04 11:46:14,660 - __main__ - INFO - epoch average loss: 0.646777
2025-12-04 11:46:14,660 - __main__ - INFO - 开始测试第4轮模型效果：
2025-12-04 11:47:26,372 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 11:47:26,373 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 11:47:26,373 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 11:47:26,373 - __main__ - INFO - --------------------
2025-12-04 11:47:26,374 - __main__ - INFO - epoch 5 begin
2025-12-04 11:47:39,330 - __main__ - INFO - batch loss 0.666519
2025-12-04 11:55:24,206 - __main__ - INFO - batch loss 0.624390
2025-12-04 12:03:11,371 - __main__ - INFO - batch loss 0.628002
2025-12-04 12:03:11,371 - __main__ - INFO - epoch average loss: 0.641979
2025-12-04 12:03:11,371 - __main__ - INFO - 开始测试第5轮模型效果：
2025-12-04 12:04:23,695 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 12:04:23,695 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 12:04:23,695 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 12:04:23,695 - __main__ - INFO - --------------------
2025-12-04 12:04:23,697 - __main__ - INFO - epoch 6 begin
2025-12-04 12:04:36,474 - __main__ - INFO - batch loss 0.580183
2025-12-04 12:12:18,972 - __main__ - INFO - batch loss 0.623613
2025-12-04 12:20:04,463 - __main__ - INFO - batch loss 0.653979
2025-12-04 12:20:04,463 - __main__ - INFO - epoch average loss: 0.637732
2025-12-04 12:20:04,463 - __main__ - INFO - 开始测试第6轮模型效果：
2025-12-04 12:21:16,492 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 12:21:16,492 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 12:21:16,492 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 12:21:16,492 - __main__ - INFO - --------------------
2025-12-04 12:21:16,494 - __main__ - INFO - epoch 7 begin
2025-12-04 12:21:29,235 - __main__ - INFO - batch loss 0.668036
2025-12-04 12:29:16,647 - __main__ - INFO - batch loss 0.605785
2025-12-04 12:37:05,155 - __main__ - INFO - batch loss 0.642384
2025-12-04 12:37:05,155 - __main__ - INFO - epoch average loss: 0.648984
2025-12-04 12:37:05,155 - __main__ - INFO - 开始测试第7轮模型效果：
2025-12-04 12:38:17,972 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 12:38:17,972 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 12:38:17,972 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 12:38:17,972 - __main__ - INFO - --------------------
2025-12-04 12:38:17,974 - __main__ - INFO - epoch 8 begin
2025-12-04 12:38:30,735 - __main__ - INFO - batch loss 0.579513
2025-12-04 12:46:16,304 - __main__ - INFO - batch loss 0.602304
2025-12-04 12:53:59,093 - __main__ - INFO - batch loss 0.632866
2025-12-04 12:53:59,093 - __main__ - INFO - epoch average loss: 0.644925
2025-12-04 12:53:59,093 - __main__ - INFO - 开始测试第8轮模型效果：
2025-12-04 12:55:10,926 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 12:55:10,927 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 12:55:10,927 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 12:55:10,927 - __main__ - INFO - --------------------
2025-12-04 12:55:10,928 - __main__ - INFO - epoch 9 begin
2025-12-04 12:55:23,748 - __main__ - INFO - batch loss 0.662981
2025-12-04 13:03:12,356 - __main__ - INFO - batch loss 0.649237
2025-12-04 13:10:55,066 - __main__ - INFO - batch loss 0.629657
2025-12-04 13:10:55,067 - __main__ - INFO - epoch average loss: 0.643545
2025-12-04 13:10:55,067 - __main__ - INFO - 开始测试第9轮模型效果：
2025-12-04 13:12:06,789 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 13:12:06,789 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 13:12:06,789 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 13:12:06,789 - __main__ - INFO - --------------------
2025-12-04 13:12:06,790 - __main__ - INFO - epoch 10 begin
2025-12-04 13:12:19,616 - __main__ - INFO - batch loss 0.649107
2025-12-04 13:20:06,367 - __main__ - INFO - batch loss 0.654556
2025-12-04 13:27:47,502 - __main__ - INFO - batch loss 0.661802
2025-12-04 13:27:47,502 - __main__ - INFO - epoch average loss: 0.640564
2025-12-04 13:27:47,503 - __main__ - INFO - 开始测试第10轮模型效果：
2025-12-04 13:28:59,067 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 13:28:59,067 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 13:28:59,067 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 13:28:59,067 - __main__ - INFO - --------------------
最后一轮准确率： 0.664720600500417 当前配置： {'model_path': 'output', 'train_data_path': '../data/train_tag_news.json', 'valid_data_path': '../data/test_tag_news.json', 'vocab_path': 'chars.txt', 'model_type': 'bert', 'max_length': 30, 'hidden_size': 128, 'kernel_size': 3, 'num_layers': 2, 'epoch': 10, 'batch_size': 128, 'pooling_style': 'avg', 'optimizer': 'adam', 'learning_rate': 0.001, 'pretrain_model_path': 'D:\\ANACONDA\\envs\\py312\\Lib\\site-packages\\modelscope\\hub\\models\\google-bert\\bert-base-chinese', 'seed': 987, 'class_num': 18, 'vocab_size': 4622}
2025-12-04 13:29:03,822 - __main__ - INFO - epoch 1 begin
2025-12-04 13:29:16,642 - __main__ - INFO - batch loss 3.471399
2025-12-04 13:37:06,442 - __main__ - INFO - batch loss 0.667226
2025-12-04 13:44:51,725 - __main__ - INFO - batch loss 0.598923
2025-12-04 13:44:51,726 - __main__ - INFO - epoch average loss: 0.832879
2025-12-04 13:44:51,726 - __main__ - INFO - 开始测试第1轮模型效果：
2025-12-04 13:46:04,141 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 13:46:04,141 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 13:46:04,141 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 13:46:04,141 - __main__ - INFO - --------------------
2025-12-04 13:46:04,143 - __main__ - INFO - epoch 2 begin
2025-12-04 13:46:16,937 - __main__ - INFO - batch loss 0.629657
2025-12-04 13:54:04,289 - __main__ - INFO - batch loss 0.660786
2025-12-04 14:01:47,582 - __main__ - INFO - batch loss 0.670966
2025-12-04 14:01:47,582 - __main__ - INFO - epoch average loss: 0.643015
2025-12-04 14:01:47,582 - __main__ - INFO - 开始测试第2轮模型效果：
2025-12-04 14:02:59,709 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 14:02:59,709 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 14:02:59,709 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 14:02:59,709 - __main__ - INFO - --------------------
2025-12-04 14:02:59,711 - __main__ - INFO - epoch 3 begin
2025-12-04 14:03:12,771 - __main__ - INFO - batch loss 0.622919
2025-12-04 14:10:57,494 - __main__ - INFO - batch loss 0.676652
2025-12-04 14:18:45,895 - __main__ - INFO - batch loss 0.606471
2025-12-04 14:18:45,895 - __main__ - INFO - epoch average loss: 0.641844
2025-12-04 14:18:45,896 - __main__ - INFO - 开始测试第3轮模型效果：
2025-12-04 14:19:58,306 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 14:19:58,306 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 14:19:58,306 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 14:19:58,306 - __main__ - INFO - --------------------
2025-12-04 14:19:58,308 - __main__ - INFO - epoch 4 begin
2025-12-04 14:20:11,027 - __main__ - INFO - batch loss 0.617033
2025-12-04 14:27:55,647 - __main__ - INFO - batch loss 0.658759
2025-12-04 14:35:41,587 - __main__ - INFO - batch loss 0.655387
2025-12-04 14:35:41,587 - __main__ - INFO - epoch average loss: 0.645389
2025-12-04 14:35:41,587 - __main__ - INFO - 开始测试第4轮模型效果：
2025-12-04 14:36:53,929 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 14:36:53,929 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 14:36:53,929 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 14:36:53,929 - __main__ - INFO - --------------------
2025-12-04 14:36:53,931 - __main__ - INFO - epoch 5 begin
2025-12-04 14:37:06,646 - __main__ - INFO - batch loss 0.631623
2025-12-04 14:44:52,999 - __main__ - INFO - batch loss 0.614055
2025-12-04 14:52:36,833 - __main__ - INFO - batch loss 0.649078
2025-12-04 14:52:36,833 - __main__ - INFO - epoch average loss: 0.646883
2025-12-04 14:52:36,833 - __main__ - INFO - 开始测试第5轮模型效果：
2025-12-04 14:53:49,982 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 14:53:49,982 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 14:53:49,982 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 14:53:49,982 - __main__ - INFO - --------------------
2025-12-04 14:53:49,984 - __main__ - INFO - epoch 6 begin
2025-12-04 14:54:02,982 - __main__ - INFO - batch loss 0.625739
2025-12-04 15:01:46,937 - __main__ - INFO - batch loss 0.669128
2025-12-04 15:09:32,217 - __main__ - INFO - batch loss 0.660214
2025-12-04 15:09:32,218 - __main__ - INFO - epoch average loss: 0.641856
2025-12-04 15:09:32,218 - __main__ - INFO - 开始测试第6轮模型效果：
2025-12-04 15:10:43,792 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 15:10:43,792 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 15:10:43,792 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 15:10:43,792 - __main__ - INFO - --------------------
2025-12-04 15:10:43,794 - __main__ - INFO - epoch 7 begin
2025-12-04 15:10:56,556 - __main__ - INFO - batch loss 0.660044
2025-12-04 15:18:41,103 - __main__ - INFO - batch loss 0.630595
2025-12-04 15:26:23,827 - __main__ - INFO - batch loss 0.668310
2025-12-04 15:26:23,827 - __main__ - INFO - epoch average loss: 0.643007
2025-12-04 15:26:23,827 - __main__ - INFO - 开始测试第7轮模型效果：
2025-12-04 15:27:35,727 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 15:27:35,727 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 15:27:35,727 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 15:27:35,727 - __main__ - INFO - --------------------
2025-12-04 15:27:35,729 - __main__ - INFO - epoch 8 begin
2025-12-04 15:27:48,403 - __main__ - INFO - batch loss 0.653679
2025-12-04 15:35:35,361 - __main__ - INFO - batch loss 0.678228
2025-12-04 15:43:21,176 - __main__ - INFO - batch loss 0.649770
2025-12-04 15:43:21,176 - __main__ - INFO - epoch average loss: 0.645668
2025-12-04 15:43:21,176 - __main__ - INFO - 开始测试第8轮模型效果：
2025-12-04 15:44:33,643 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 15:44:33,643 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 15:44:33,643 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 15:44:33,643 - __main__ - INFO - --------------------
2025-12-04 15:44:33,645 - __main__ - INFO - epoch 9 begin
2025-12-04 15:44:46,368 - __main__ - INFO - batch loss 0.640171
2025-12-04 15:52:30,880 - __main__ - INFO - batch loss 0.611521
2025-12-04 16:00:14,865 - __main__ - INFO - batch loss 0.633771
2025-12-04 16:00:14,866 - __main__ - INFO - epoch average loss: 0.642147
2025-12-04 16:00:14,866 - __main__ - INFO - 开始测试第9轮模型效果：
2025-12-04 16:01:26,528 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 16:01:26,528 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 16:01:26,528 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 16:01:26,528 - __main__ - INFO - --------------------
2025-12-04 16:01:26,530 - __main__ - INFO - epoch 10 begin
2025-12-04 16:01:39,380 - __main__ - INFO - batch loss 0.648980
2025-12-04 16:09:23,989 - __main__ - INFO - batch loss 0.657315
2025-12-04 16:17:08,158 - __main__ - INFO - batch loss 0.660680
2025-12-04 16:17:08,159 - __main__ - INFO - epoch average loss: 0.640643
2025-12-04 16:17:08,159 - __main__ - INFO - 开始测试第10轮模型效果：
2025-12-04 16:18:21,438 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 16:18:21,438 - __main__ - INFO - 预测正确条目：1594，预测错误条目：804
2025-12-04 16:18:21,438 - __main__ - INFO - 预测准确率：0.664721
2025-12-04 16:18:21,438 - __main__ - INFO - --------------------
最后一轮准确率： 0.664720600500417 当前配置： {'model_path': 'output', 'train_data_path': '../data/train_tag_news.json', 'valid_data_path': '../data/test_tag_news.json', 'vocab_path': 'chars.txt', 'model_type': 'bert', 'max_length': 30, 'hidden_size': 128, 'kernel_size': 3, 'num_layers': 2, 'epoch': 10, 'batch_size': 128, 'pooling_style': 'max', 'optimizer': 'adam', 'learning_rate': 0.001, 'pretrain_model_path': 'D:\\ANACONDA\\envs\\py312\\Lib\\site-packages\\modelscope\\hub\\models\\google-bert\\bert-base-chinese', 'seed': 987, 'class_num': 18, 'vocab_size': 4622}
learning_rate: 0.0001
hidden_size: 128
batch_size: 64
2025-12-04 16:18:26,067 - __main__ - INFO - epoch 1 begin
2025-12-04 16:18:32,943 - __main__ - INFO - batch loss 2.668350
2025-12-04 16:26:47,813 - __main__ - INFO - batch loss 0.410390
2025-12-04 16:34:55,138 - __main__ - INFO - epoch average loss: 0.351103
2025-12-04 16:34:55,138 - __main__ - INFO - 开始测试第1轮模型效果：
2025-12-04 16:36:08,367 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 16:36:08,367 - __main__ - INFO - 预测正确条目：2148，预测错误条目：250
2025-12-04 16:36:08,367 - __main__ - INFO - 预测准确率：0.895746
2025-12-04 16:36:08,368 - __main__ - INFO - --------------------
2025-12-04 16:36:08,369 - __main__ - INFO - epoch 2 begin
2025-12-04 16:36:14,958 - __main__ - INFO - batch loss 0.315058
2025-12-04 16:44:29,761 - __main__ - INFO - batch loss 0.188759
2025-12-04 16:52:36,644 - __main__ - INFO - epoch average loss: 0.233279
2025-12-04 16:52:36,644 - __main__ - INFO - 开始测试第2轮模型效果：
2025-12-04 16:53:50,543 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 16:53:50,543 - __main__ - INFO - 预测正确条目：2144，预测错误条目：254
2025-12-04 16:53:50,543 - __main__ - INFO - 预测准确率：0.894078
2025-12-04 16:53:50,543 - __main__ - INFO - --------------------
2025-12-04 16:53:50,545 - __main__ - INFO - epoch 3 begin
2025-12-04 16:53:57,126 - __main__ - INFO - batch loss 0.242854
2025-12-04 17:02:11,710 - __main__ - INFO - batch loss 0.154208
2025-12-04 17:10:19,492 - __main__ - INFO - epoch average loss: 0.186956
2025-12-04 17:10:19,492 - __main__ - INFO - 开始测试第3轮模型效果：
2025-12-04 17:11:32,446 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 17:11:32,446 - __main__ - INFO - 预测正确条目：2183，预测错误条目：215
2025-12-04 17:11:32,446 - __main__ - INFO - 预测准确率：0.910342
2025-12-04 17:11:32,446 - __main__ - INFO - --------------------
2025-12-04 17:11:32,448 - __main__ - INFO - epoch 4 begin
2025-12-04 17:11:39,120 - __main__ - INFO - batch loss 0.082579
2025-12-04 17:19:54,512 - __main__ - INFO - batch loss 0.142739
2025-12-04 17:28:01,344 - __main__ - INFO - epoch average loss: 0.143673
2025-12-04 17:28:01,344 - __main__ - INFO - 开始测试第4轮模型效果：
2025-12-04 17:29:14,819 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 17:29:14,819 - __main__ - INFO - 预测正确条目：2162，预测错误条目：236
2025-12-04 17:29:14,819 - __main__ - INFO - 预测准确率：0.901585
2025-12-04 17:29:14,819 - __main__ - INFO - --------------------
2025-12-04 17:29:14,821 - __main__ - INFO - epoch 5 begin
2025-12-04 17:29:21,426 - __main__ - INFO - batch loss 0.069317
2025-12-04 17:37:37,722 - __main__ - INFO - batch loss 0.052379
2025-12-04 17:45:46,318 - __main__ - INFO - epoch average loss: 0.111418
2025-12-04 17:45:46,318 - __main__ - INFO - 开始测试第5轮模型效果：
2025-12-04 17:46:59,782 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 17:46:59,782 - __main__ - INFO - 预测正确条目：2156，预测错误条目：242
2025-12-04 17:46:59,782 - __main__ - INFO - 预测准确率：0.899083
2025-12-04 17:46:59,782 - __main__ - INFO - --------------------
2025-12-04 17:46:59,784 - __main__ - INFO - epoch 6 begin
2025-12-04 17:47:06,351 - __main__ - INFO - batch loss 0.115791
2025-12-04 17:55:22,065 - __main__ - INFO - batch loss 0.185876
2025-12-04 18:03:35,020 - __main__ - INFO - epoch average loss: 0.098483
2025-12-04 18:03:35,020 - __main__ - INFO - 开始测试第6轮模型效果：
2025-12-04 18:04:54,145 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 18:04:54,145 - __main__ - INFO - 预测正确条目：2169，预测错误条目：229
2025-12-04 18:04:54,145 - __main__ - INFO - 预测准确率：0.904504
2025-12-04 18:04:54,145 - __main__ - INFO - --------------------
2025-12-04 18:04:54,147 - __main__ - INFO - epoch 7 begin
2025-12-04 18:05:01,270 - __main__ - INFO - batch loss 0.052183
2025-12-04 18:13:27,504 - __main__ - INFO - batch loss 0.106758
2025-12-04 18:21:48,716 - __main__ - INFO - epoch average loss: 0.078394
2025-12-04 18:21:48,717 - __main__ - INFO - 开始测试第7轮模型效果：
2025-12-04 18:23:02,834 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 18:23:02,835 - __main__ - INFO - 预测正确条目：2082，预测错误条目：316
2025-12-04 18:23:02,835 - __main__ - INFO - 预测准确率：0.868224
2025-12-04 18:23:02,835 - __main__ - INFO - --------------------
2025-12-04 18:23:02,836 - __main__ - INFO - epoch 8 begin
2025-12-04 18:23:09,556 - __main__ - INFO - batch loss 0.148826
2025-12-04 18:31:45,442 - __main__ - INFO - batch loss 0.097677


D:\ANACONDA\envs\py312\python.exe "D:\AI  Learning\课程内容\SEVEN_Week\SEVENWEEK\week7 文本分类问题\nn_pipline\main.py" 
2025-12-04 18:34:41,500 - __main__ - INFO - epoch 1 begin
2025-12-04 18:34:41,692 - __main__ - INFO - batch loss 2.918313
2025-12-04 18:34:48,027 - __main__ - INFO - batch loss 0.465641
2025-12-04 18:34:54,345 - __main__ - INFO - batch loss 0.419356
2025-12-04 18:34:54,345 - __main__ - INFO - epoch average loss: 0.726089
2025-12-04 18:34:54,345 - __main__ - INFO - 开始测试第1轮模型效果：
2025-12-04 18:34:55,529 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 18:34:55,529 - __main__ - INFO - 预测正确条目：2039，预测错误条目：359
2025-12-04 18:34:55,529 - __main__ - INFO - 预测准确率：0.850292
2025-12-04 18:34:55,529 - __main__ - INFO - --------------------
2025-12-04 18:34:55,529 - __main__ - INFO - epoch 2 begin
2025-12-04 18:34:55,706 - __main__ - INFO - batch loss 0.403258
2025-12-04 18:35:02,168 - __main__ - INFO - batch loss 0.354083
2025-12-04 18:35:08,566 - __main__ - INFO - batch loss 0.277377
2025-12-04 18:35:08,567 - __main__ - INFO - epoch average loss: 0.366316
2025-12-04 18:35:08,567 - __main__ - INFO - 开始测试第2轮模型效果：
2025-12-04 18:35:09,738 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 18:35:09,738 - __main__ - INFO - 预测正确条目：2090，预测错误条目：308
2025-12-04 18:35:09,738 - __main__ - INFO - 预测准确率：0.871560
2025-12-04 18:35:09,738 - __main__ - INFO - --------------------
2025-12-04 18:35:09,738 - __main__ - INFO - epoch 3 begin
2025-12-04 18:35:09,905 - __main__ - INFO - batch loss 0.255143
2025-12-04 18:35:16,693 - __main__ - INFO - batch loss 0.228682
2025-12-04 18:35:23,672 - __main__ - INFO - batch loss 0.344032
2025-12-04 18:35:23,674 - __main__ - INFO - epoch average loss: 0.306417
2025-12-04 18:35:23,674 - __main__ - INFO - 开始测试第3轮模型效果：
2025-12-04 18:35:24,949 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 18:35:24,949 - __main__ - INFO - 预测正确条目：2142，预测错误条目：256
2025-12-04 18:35:24,949 - __main__ - INFO - 预测准确率：0.893244
2025-12-04 18:35:24,949 - __main__ - INFO - --------------------
2025-12-04 18:35:24,949 - __main__ - INFO - epoch 4 begin
2025-12-04 18:35:25,134 - __main__ - INFO - batch loss 0.206492
2025-12-04 18:35:31,728 - __main__ - INFO - batch loss 0.309465
2025-12-04 18:35:38,474 - __main__ - INFO - batch loss 0.344036
2025-12-04 18:35:38,475 - __main__ - INFO - epoch average loss: 0.264675
2025-12-04 18:35:38,475 - __main__ - INFO - 开始测试第4轮模型效果：
2025-12-04 18:35:39,755 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 18:35:39,756 - __main__ - INFO - 预测正确条目：2110，预测错误条目：288
2025-12-04 18:35:39,756 - __main__ - INFO - 预测准确率：0.879900
2025-12-04 18:35:39,756 - __main__ - INFO - --------------------
2025-12-04 18:35:39,756 - __main__ - INFO - epoch 5 begin
2025-12-04 18:35:39,936 - __main__ - INFO - batch loss 0.277812
2025-12-04 18:35:46,553 - __main__ - INFO - batch loss 0.146384
2025-12-04 18:35:53,398 - __main__ - INFO - batch loss 0.350212
2025-12-04 18:35:53,398 - __main__ - INFO - epoch average loss: 0.229800
2025-12-04 18:35:53,399 - __main__ - INFO - 开始测试第5轮模型效果：
2025-12-04 18:35:55,001 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 18:35:55,001 - __main__ - INFO - 预测正确条目：2140，预测错误条目：258
2025-12-04 18:35:55,002 - __main__ - INFO - 预测准确率：0.892410
2025-12-04 18:35:55,002 - __main__ - INFO - --------------------
2025-12-04 18:35:55,002 - __main__ - INFO - epoch 6 begin
2025-12-04 18:35:55,381 - __main__ - INFO - batch loss 0.183494
2025-12-04 18:36:02,973 - __main__ - INFO - batch loss 0.294416
2025-12-04 18:36:09,714 - __main__ - INFO - batch loss 0.202338
2025-12-04 18:36:09,714 - __main__ - INFO - epoch average loss: 0.204002
2025-12-04 18:36:09,714 - __main__ - INFO - 开始测试第6轮模型效果：
2025-12-04 18:36:10,893 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 18:36:10,893 - __main__ - INFO - 预测正确条目：2139，预测错误条目：259
2025-12-04 18:36:10,893 - __main__ - INFO - 预测准确率：0.891993
2025-12-04 18:36:10,893 - __main__ - INFO - --------------------
2025-12-04 18:36:10,893 - __main__ - INFO - epoch 7 begin
2025-12-04 18:36:11,069 - __main__ - INFO - batch loss 0.190853
2025-12-04 18:36:17,783 - __main__ - INFO - batch loss 0.231352
2025-12-04 18:36:24,449 - __main__ - INFO - batch loss 0.265290
2025-12-04 18:36:24,449 - __main__ - INFO - epoch average loss: 0.174330
2025-12-04 18:36:24,449 - __main__ - INFO - 开始测试第7轮模型效果：
2025-12-04 18:36:25,644 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 18:36:25,644 - __main__ - INFO - 预测正确条目：2134，预测错误条目：264
2025-12-04 18:36:25,644 - __main__ - INFO - 预测准确率：0.889908
2025-12-04 18:36:25,644 - __main__ - INFO - --------------------
2025-12-04 18:36:25,644 - __main__ - INFO - epoch 8 begin
2025-12-04 18:36:25,819 - __main__ - INFO - batch loss 0.127157
2025-12-04 18:36:32,188 - __main__ - INFO - batch loss 0.130861
2025-12-04 18:36:38,556 - __main__ - INFO - batch loss 0.160986
2025-12-04 18:36:38,557 - __main__ - INFO - epoch average loss: 0.151454
2025-12-04 18:36:38,557 - __main__ - INFO - 开始测试第8轮模型效果：
2025-12-04 18:36:39,730 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 18:36:39,730 - __main__ - INFO - 预测正确条目：2116，预测错误条目：282
2025-12-04 18:36:39,730 - __main__ - INFO - 预测准确率：0.882402
2025-12-04 18:36:39,730 - __main__ - INFO - --------------------
2025-12-04 18:36:39,731 - __main__ - INFO - epoch 9 begin
2025-12-04 18:36:39,895 - __main__ - INFO - batch loss 0.121857
2025-12-04 18:36:46,280 - __main__ - INFO - batch loss 0.083757
2025-12-04 18:36:52,595 - __main__ - INFO - batch loss 0.144336
2025-12-04 18:36:52,595 - __main__ - INFO - epoch average loss: 0.128215
2025-12-04 18:36:52,595 - __main__ - INFO - 开始测试第9轮模型效果：
2025-12-04 18:36:53,770 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 18:36:53,771 - __main__ - INFO - 预测正确条目：2122，预测错误条目：276
2025-12-04 18:36:53,771 - __main__ - INFO - 预测准确率：0.884904
2025-12-04 18:36:53,771 - __main__ - INFO - --------------------
2025-12-04 18:36:53,771 - __main__ - INFO - epoch 10 begin
2025-12-04 18:36:53,943 - __main__ - INFO - batch loss 0.109099
2025-12-04 18:37:00,268 - __main__ - INFO - batch loss 0.053279
2025-12-04 18:37:06,635 - __main__ - INFO - batch loss 0.131104
2025-12-04 18:37:06,635 - __main__ - INFO - epoch average loss: 0.115089
2025-12-04 18:37:06,635 - __main__ - INFO - 开始测试第10轮模型效果：
2025-12-04 18:37:07,803 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 18:37:07,803 - __main__ - INFO - 预测正确条目：2134，预测错误条目：264
2025-12-04 18:37:07,803 - __main__ - INFO - 预测准确率：0.889908
2025-12-04 18:37:07,803 - __main__ - INFO - --------------------
2025-12-04 18:37:08,158 - __main__ - INFO - epoch 1 begin
2025-12-04 18:37:08,339 - __main__ - INFO - batch loss 2.913518
2025-12-04 18:37:14,657 - __main__ - INFO - batch loss 0.600695
2025-12-04 18:37:20,927 - __main__ - INFO - batch loss 0.401612
2025-12-04 18:37:20,927 - __main__ - INFO - epoch average loss: 0.765153
2025-12-04 18:37:20,927 - __main__ - INFO - 开始测试第1轮模型效果：
2025-12-04 18:37:22,110 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 18:37:22,110 - __main__ - INFO - 预测正确条目：2006，预测错误条目：392
2025-12-04 18:37:22,110 - __main__ - INFO - 预测准确率：0.836530
2025-12-04 18:37:22,110 - __main__ - INFO - --------------------
2025-12-04 18:37:22,111 - __main__ - INFO - epoch 2 begin
2025-12-04 18:37:22,292 - __main__ - INFO - batch loss 0.415568
2025-12-04 18:37:28,630 - __main__ - INFO - batch loss 0.325776
2025-12-04 18:37:34,962 - __main__ - INFO - batch loss 0.382353
2025-12-04 18:37:34,963 - __main__ - INFO - epoch average loss: 0.368416
2025-12-04 18:37:34,963 - __main__ - INFO - 开始测试第2轮模型效果：
2025-12-04 18:37:36,147 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 18:37:36,147 - __main__ - INFO - 预测正确条目：2083，预测错误条目：315
2025-12-04 18:37:36,147 - __main__ - INFO - 预测准确率：0.868641
2025-12-04 18:37:36,147 - __main__ - INFO - --------------------
2025-12-04 18:37:36,148 - __main__ - INFO - epoch 3 begin
2025-12-04 18:37:36,325 - __main__ - INFO - batch loss 0.298687
2025-12-04 18:37:42,623 - __main__ - INFO - batch loss 0.247722
2025-12-04 18:37:48,938 - __main__ - INFO - batch loss 0.369078
2025-12-04 18:37:48,938 - __main__ - INFO - epoch average loss: 0.312205
2025-12-04 18:37:48,939 - __main__ - INFO - 开始测试第3轮模型效果：
2025-12-04 18:37:50,114 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 18:37:50,114 - __main__ - INFO - 预测正确条目：2134，预测错误条目：264
2025-12-04 18:37:50,114 - __main__ - INFO - 预测准确率：0.889908
2025-12-04 18:37:50,114 - __main__ - INFO - --------------------
2025-12-04 18:37:50,114 - __main__ - INFO - epoch 4 begin
2025-12-04 18:37:50,291 - __main__ - INFO - batch loss 0.278415
2025-12-04 18:37:56,673 - __main__ - INFO - batch loss 0.173693
2025-12-04 18:38:03,763 - __main__ - INFO - batch loss 0.345198
2025-12-04 18:38:03,763 - __main__ - INFO - epoch average loss: 0.281440
2025-12-04 18:38:03,763 - __main__ - INFO - 开始测试第4轮模型效果：
2025-12-04 18:38:05,023 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 18:38:05,023 - __main__ - INFO - 预测正确条目：2132，预测错误条目：266
2025-12-04 18:38:05,024 - __main__ - INFO - 预测准确率：0.889074
2025-12-04 18:38:05,024 - __main__ - INFO - --------------------
2025-12-04 18:38:05,024 - __main__ - INFO - epoch 5 begin
2025-12-04 18:38:05,212 - __main__ - INFO - batch loss 0.292457
2025-12-04 18:38:11,825 - __main__ - INFO - batch loss 0.260089
2025-12-04 18:38:18,406 - __main__ - INFO - batch loss 0.227290
2025-12-04 18:38:18,406 - __main__ - INFO - epoch average loss: 0.244616
2025-12-04 18:38:18,406 - __main__ - INFO - 开始测试第5轮模型效果：
2025-12-04 18:38:19,565 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 18:38:19,565 - __main__ - INFO - 预测正确条目：2162，预测错误条目：236
2025-12-04 18:38:19,566 - __main__ - INFO - 预测准确率：0.901585
2025-12-04 18:38:19,566 - __main__ - INFO - --------------------
2025-12-04 18:38:19,566 - __main__ - INFO - epoch 6 begin
2025-12-04 18:38:19,745 - __main__ - INFO - batch loss 0.263151
2025-12-04 18:38:26,210 - __main__ - INFO - batch loss 0.274259
2025-12-04 18:38:32,625 - __main__ - INFO - batch loss 0.187591
2025-12-04 18:38:32,625 - __main__ - INFO - epoch average loss: 0.219531
2025-12-04 18:38:32,625 - __main__ - INFO - 开始测试第6轮模型效果：
2025-12-04 18:38:33,789 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 18:38:33,789 - __main__ - INFO - 预测正确条目：2152，预测错误条目：246
2025-12-04 18:38:33,789 - __main__ - INFO - 预测准确率：0.897415
2025-12-04 18:38:33,789 - __main__ - INFO - --------------------
2025-12-04 18:38:33,789 - __main__ - INFO - epoch 7 begin
2025-12-04 18:38:33,956 - __main__ - INFO - batch loss 0.160150
2025-12-04 18:38:40,424 - __main__ - INFO - batch loss 0.182258
2025-12-04 18:38:46,852 - __main__ - INFO - batch loss 0.144475
2025-12-04 18:38:46,852 - __main__ - INFO - epoch average loss: 0.197228
2025-12-04 18:38:46,852 - __main__ - INFO - 开始测试第7轮模型效果：
2025-12-04 18:38:48,027 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 18:38:48,027 - __main__ - INFO - 预测正确条目：2131，预测错误条目：267
2025-12-04 18:38:48,027 - __main__ - INFO - 预测准确率：0.888657
2025-12-04 18:38:48,027 - __main__ - INFO - --------------------
2025-12-04 18:38:48,027 - __main__ - INFO - epoch 8 begin
2025-12-04 18:38:48,203 - __main__ - INFO - batch loss 0.173040
2025-12-04 18:38:54,759 - __main__ - INFO - batch loss 0.168772
2025-12-04 18:39:01,122 - __main__ - INFO - batch loss 0.132699
2025-12-04 18:39:01,122 - __main__ - INFO - epoch average loss: 0.174080
2025-12-04 18:39:01,122 - __main__ - INFO - 开始测试第8轮模型效果：
2025-12-04 18:39:02,289 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 18:39:02,289 - __main__ - INFO - 预测正确条目：2124，预测错误条目：274
2025-12-04 18:39:02,289 - __main__ - INFO - 预测准确率：0.885738
2025-12-04 18:39:02,289 - __main__ - INFO - --------------------
2025-12-04 18:39:02,289 - __main__ - INFO - epoch 9 begin
2025-12-04 18:39:02,460 - __main__ - INFO - batch loss 0.130825
2025-12-04 18:39:08,885 - __main__ - INFO - batch loss 0.195914
2025-12-04 18:39:15,196 - __main__ - INFO - batch loss 0.131639
2025-12-04 18:39:15,197 - __main__ - INFO - epoch average loss: 0.146055
2025-12-04 18:39:15,197 - __main__ - INFO - 开始测试第9轮模型效果：
2025-12-04 18:39:16,354 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 18:39:16,354 - __main__ - INFO - 预测正确条目：2142，预测错误条目：256
2025-12-04 18:39:16,354 - __main__ - INFO - 预测准确率：0.893244
2025-12-04 18:39:16,354 - __main__ - INFO - --------------------
2025-12-04 18:39:16,354 - __main__ - INFO - epoch 10 begin
2025-12-04 18:39:16,530 - __main__ - INFO - batch loss 0.137646
2025-12-04 18:39:22,880 - __main__ - INFO - batch loss 0.067141
2025-12-04 18:39:29,202 - __main__ - INFO - batch loss 0.073055
2025-12-04 18:39:29,202 - __main__ - INFO - epoch average loss: 0.128021
2025-12-04 18:39:29,202 - __main__ - INFO - 开始测试第10轮模型效果：
2025-12-04 18:39:30,355 - __main__ - INFO - 预测集合条目总量：2398
2025-12-04 18:39:30,355 - __main__ - INFO - 预测正确条目：2135，预测错误条目：263
2025-12-04 18:39:30,355 - __main__ - INFO - 预测准确率：0.890325
2025-12-04 18:39:30,355 - __main__ - INFO - --------------------
最后一轮准确率： 0.890325271059216 当前配置： {'model_path': 'output', 'train_data_path': '../data/train_tag_news.json', 'valid_data_path': '../data/test_tag_news.json', 'vocab_path': 'chars.txt', 'model_type': 'lstm', 'max_length': 30, 'hidden_size': 256, 'kernel_size': 3, 'num_layers': 2, 'epoch': 10, 'batch_size': 128, 'pooling_style': 'max', 'optimizer': 'adam', 'learning_rate': 0.001, 'pretrain_model_path': 'D:\\ANACONDA\\envs\\py312\\Lib\\site-packages\\modelscope\\hub\\models\\google-bert\\bert-base-chinese', 'seed': 987, 'class_num': 18, 'vocab_size': 4622}

Process finished with exit code 0

